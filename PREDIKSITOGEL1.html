<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prediksi Togel</title>
  
  <!-- Favicon -->
  <link rel="icon" href="https://i.imgur.com/fd8tzKi.png" type="image/png" sizes="32x32">
  <link rel="apple-touch-icon" href="https://i.imgur.com/fd8tzKi.png">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Rubik+Doodle+Shadow&family=Montserrat:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Styles -->
  <style>
    :root {
      --primary: #6a11cb;
      --primary-dark: #2575fc;
      --secondary: #ff416c;
      --secondary-dark: #ff4b2b;
      --accent: #00dbde;
      --dark: #121212;
      --darker: #0a0a0a;
      --light: #f8f9fa;
      --gray: #6c757d;
      --success: #28a745;
      --danger: #dc3545;
      --warning: #ffc107;
      --info: #17a2b8;
      --gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      --gradient-secondary: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-dark) 100%);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
      color: var(--light);
      min-height: 100vh;
      padding: 5px; /* Dikurangi dari 10px */
      display: flex;
      justify-content: center;
      align-items: flex-start;
      line-height: 1.6;
    }

    .container {
      max-width: 800px;
      width: 100%;
      margin: 0 auto;
      max-height: 95vh; /* Menambahkan tinggi maksimum */
      overflow-y: auto; /* Menambahkan scroll vertikal jika konten terlalu panjang */
      padding-bottom: 20px; /* Menambahkan padding di bagian bawah */
    }

    .prediction-container {
      background: rgba(18, 18, 18, 0.95);
      border-radius: 20px;
      padding: 15px; /* Dikurangi dari 20px */
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }

    .prediction-container::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(106, 17, 203, 0.15) 0%, rgba(37, 117, 252, 0.08) 70%, transparent 100%);
      z-index: 0;
      animation: pulse 20s infinite alternate;
    }

    @keyframes pulse {
      0% { transform: translate(0, 0) scale(1); }
      100% { transform: translate(20px, 20px) scale(1.1); }
    }

    .logo-container {
      text-align: center;
      margin-bottom: 12px; /* Dikurangi dari 15px */
      position: relative;
      z-index: 1;
    }

    .logo {
      max-width: 90px; /* Dikurangi dari 100px */
      height: auto;
      border-radius: 50%;
      border: 3px solid var(--accent);
      box-shadow: 0 0 30px rgba(0, 219, 222, 0.7);
      background: rgba(0, 0, 0, 0.3);
    }

    .floating {
      animation: floating 3s ease-in-out infinite;
    }

    @keyframes floating {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }

    h1 {
      font-family: 'Rubik Doodle Shadow', cursive;
      text-align: center;
      font-size: 2.3rem; /* Dikurangi dari 2.5rem */
      margin-bottom: 15px; /* Dikurangi dari 20px */
      background: var(--gradient-secondary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      letter-spacing: 2px;
      position: relative;
      z-index: 1;
      text-shadow: 0 5px 15px rgba(255, 65, 108, 0.3);
    }

    .glow {
      animation: glow 2s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { text-shadow: 0 0 10px rgba(255, 65, 108, 0.5); }
      to { text-shadow: 0 0 20px rgba(255, 65, 108, 0.8), 0 0 30px rgba(255, 65, 108, 0.4); }
    }

    .form-group {
      margin-bottom: 15px; /* Dikurangi dari 20px */
      position: relative;
      z-index: 1;
    }

    label {
      display: block;
      margin-bottom: 6px; /* Dikurangi dari 8px */
      font-weight: 700;
      color: var(--accent);
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    select, button {
      width: 100%;
      padding: 12px 16px; /* Dikurangi dari 14px 18px */
      border-radius: 12px;
      border: none;
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      transition: all 0.3s ease;
      position: relative;
      z-index: 1;
    }

    select {
      background: rgba(0, 0, 0, 0.4);
      color: var(--light);
      border: 2px solid rgba(0, 219, 222, 0.3);
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2300dbde'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 20px center;
      background-size: 24px;
      padding-right: 55px;
      font-weight: 500;
    }

    select:hover {
      border-color: var(--accent);
      box-shadow: 0 0 15px rgba(0, 219, 222, 0.2);
    }

    select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(0, 219, 222, 0.4);
      background-color: rgba(0, 0, 0, 0.6);
    }

    select.shake {
      animation: shake 0.5s;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-8px); }
      20%, 40%, 60%, 80% { transform: translateX(8px); }
    }

    .pulse {
      background: var(--gradient);
      color: white;
      font-weight: 800;
      font-size: 1.1rem;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      letter-spacing: 1px;
      border: 2px solid transparent;
      transition: all 0.4s ease;
      margin-top: 8px; /* Dikurangi dari 10px */
    }

    .pulse:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 0 15px 30px rgba(106, 17, 203, 0.5);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .pulse:active {
      transform: translateY(-2px) scale(1);
    }

    .pulse::after {
      content: '';
      position: absolute;
      top: 0;
      left: -150%;
      width: 150%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: 0.8s;
    }

    .pulse:hover::after {
      left: 150%;
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }

    #copy-button {
      background: linear-gradient(135deg, rgba(40, 167, 69, 0.9) 0%, rgba(33, 136, 56, 0.9) 100%);
      color: white;
      margin-top: 5px; /* Dikurangi dari 10px */
      margin-bottom: 5px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      cursor: pointer;
      font-weight: 700;
      letter-spacing: 0.5px;
    }

    #copy-button:hover {
      background: linear-gradient(135deg, rgba(40, 167, 69, 1) 0%, rgba(33, 136, 56, 1) 100%);
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(40, 167, 69, 0.3);
    }

    #copy-button.copied {
      background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
      animation: pulseSuccess 0.5s;
    }

    @keyframes pulseSuccess {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    #error-message {
      color: #ff6b6b;
      background: rgba(220, 53, 69, 0.15);
      padding: 12px; /* Dikurangi dari 15px */
      border-radius: 10px;
      border-left: 4px solid var(--danger);
      margin-top: 12px; /* Dikurangi dari 15px */
      font-size: 0.9rem;
      font-weight: 500;
      display: none;
      position: relative;
      z-index: 1;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Prediction Output Styles */
    #prediction-output {
      margin-top: 15px; /* Dikurangi dari 20px */
      padding: 15px; /* Dikurangi dari 20px */
      background: rgba(0, 0, 0, 0.4);
      border-radius: 18px;
      border: 2px solid rgba(0, 219, 222, 0.2);
      display: none;
      position: relative;
      z-index: 1;
      animation: slideUp 0.5s ease;
      max-height: 60vh; /* Menambahkan tinggi maksimum untuk output prediksi */
      overflow-y: auto; /* Menambahkan scroll vertikal jika konten terlalu panjang */
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .prediction-header {
      text-align: center;
      margin-bottom: 15px; /* Dikurangi dari 20px */
      padding-bottom: 10px; /* Dikurangi dari 15px */
      border-bottom: 3px solid rgba(0, 219, 222, 0.3);
    }

    .prediction-header h2 {
      font-family: 'Rubik Doodle Shadow', cursive;
      color: var(--accent);
      font-size: 1.7rem; /* Dikurangi dari 1.8rem */
      margin-bottom: 6px; /* Dikurangi dari 8px */
      text-transform: uppercase;
      text-shadow: 0 3px 10px rgba(0, 219, 222, 0.4);
    }

    .date {
      color: #aaa;
      font-size: 0.9rem;
      font-style: italic;
      font-weight: 500;
      letter-spacing: 0.5px;
    }

    .prediction-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0; /* Dikurangi dari 10px 0 */
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      transition: background-color 0.2s ease;
    }

    .prediction-row:hover {
      background-color: rgba(255, 255, 255, 0.03);
      border-radius: 8px;
      padding-left: 10px;
      padding-right: 10px;
    }

    .prediction-row:last-child {
      border-bottom: none;
    }

    .prediction-label {
      font-weight: 700;
      color: var(--accent);
      min-width: 180px;
      font-size: 1rem;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .prediction-value {
      font-family: 'JetBrains Mono', monospace;
      font-weight: 600;
      color: white;
      text-align: right;
      flex: 1;
      font-size: 1rem;
      padding: 4px 8px; /* Dikurangi dari 5px 10px */
      background: rgba(0, 0, 0, 0.2);
      border-radius: 6px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .prediction-divider {
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(0, 219, 222, 0.3), transparent);
      margin: 10px 0; /* Dikurangi dari 15px 0 */
    }

    .inside-block {
      margin: 8px 0; /* Dikurangi dari 10px 0 */
    }

    .pasaran-block {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 15px;
      padding: 12px; /* Dikurangi dari 15px */
      margin-bottom: 8px; /* Dikurangi dari 10px */
      border: 2px solid rgba(0, 219, 222, 0.15);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      transition: transform 0.3s ease;
    }

    .pasaran-block:hover {
      transform: translateY(-5px);
      border-color: rgba(0, 219, 222, 0.3);
    }

    .pasaran-block h3 {
      color: var(--accent);
      font-size: 1.3rem;
      margin-bottom: 10px; /* Dikurangi dari 12px */
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: 700;
      text-shadow: 0 2px 8px rgba(0, 219, 222, 0.3);
    }

    .prediction-footer {
      text-align: center;
      margin-top: 10px; /* Dikurangi dari 15px */
      padding-top: 8px; /* Dikurangi dari 10px */
      border-top: 3px solid rgba(255, 255, 255, 0.1);
      color: #aaa;
      font-style: italic;
      font-weight: 500;
      font-size: 0.9rem;
      letter-spacing: 0.5px;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .container {
        padding: 5px; /* Dikurangi dari 10px */
        max-height: 90vh; /* Menyesuaikan tinggi maksimum untuk mobile */
      }
      
      .prediction-container {
        padding: 15px; /* Dikurangi dari 20px */
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .prediction-header h2 {
        font-size: 1.5rem;
      }
      
      .prediction-row {
        flex-direction: column;
        align-items: flex-start;
        padding: 8px 0; /* Dikurangi dari 10px 0 */
      }
      
      .prediction-value {
        text-align: left;
        margin-top: 8px;
        width: 100%;
      }
      
      .prediction-label {
        min-width: auto;
        margin-bottom: 5px;
      }
      
      select, button {
        padding: 10px 14px; /* Dikurangi dari 12px 16px */
      }
      
      #prediction-output {
        max-height: 50vh; /* Menyesuaikan tinggi maksimum untuk mobile */
      }
    }

    @media (max-width: 480px) {
      h1 {
        font-size: 1.7rem;
      }
      
      .prediction-container {
        padding: 12px 8px; /* Dikurangi dari 15px 10px */
      }
      
      select, button {
        padding: 9px 12px; /* Dikurangi dari 11px 14px */
        font-size: 0.9rem;
      }
      
      .logo {
        max-width: 70px; /* Dikurangi dari 80px */
      }
      
      .prediction-header h2 {
        font-size: 1.3rem;
      }
      
      #prediction-output {
        max-height: 45vh; /* Menyesuaikan tinggi maksimum untuk mobile kecil */
      }
    }

    /* Loading animation */
    .loading-dots {
      display: inline-block;
      margin-left: 5px;
    }
    
    .loading-dots span {
      animation: loadingDots 1.4s infinite;
      opacity: 0;
    }
    
    .loading-dots span:nth-child(1) { animation-delay: 0s; }
    .loading-dots span:nth-child(2) { animation-delay: 0.2s; }
    .loading-dots span:nth-child(3) { animation-delay: 0.4s; }
    
    @keyframes loadingDots {
      0%, 80%, 100% { opacity: 0; }
      30%, 50% { opacity: 1; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="prediction-container">
      <div class="logo-container">
        <img src="https://cdn.areabermain.club/assets/cdn/az4/2025/04/23/20250423/a82bdc6fb564d0dff3671aeb9a4d1da5/logo.png" 
             alt="Prediksi Togel Logo" 
             class="logo floating">
      </div>

      <h1 class="glow">Prediksi Togel</h1>

      <div class="form-group">
        <label for="prediction-type"><i class="fas fa-cogs"></i> JENIS PREDIKSI:</label>
        <select id="prediction-type">
          <option value="single">Single Pasaran</option>
          <option value="all">All Pasaran</option>
        </select>
      </div>

      <div class="form-group" id="pasaran-group">
        <label for="pasaran"><i class="fas fa-list"></i> PILIH PASARAN:</label>
        <select id="pasaran" required>
          <option value="" disabled selected>-- Pilih Pasaran --</option>
        </select>
      </div>

      <button id="generate-button" class="pulse">
        <i class="fas fa-spinner fa-spin" id="loading-spinner" style="display: none; margin-right: 10px;"></i>
        <span id="generate-text">GENERATE PREDIKSI</span>
        <i class="fas fa-magic" style="margin-left: 10px;"></i>
      </button>

      <div id="error-message"></div>
      
      <div id="prediction-output"></div>
      
      <button id="copy-button" style="display: none;">
        <i class="fas fa-copy" style="margin-right: 10px;"></i>
        <span>SALIN HASIL</span>
      </button>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    // ==================== KONFIGURASI ====================
    const Config = {
      PASARAN: [
        "BANGKOK 0130", "BANGKOK 0930", "BRUNEI 02", "BRUNEI 14", "BRUNEI 21",
        "BULLSEYE", "CALIFORNIA", "CAROLINA EVENING", "CHELSEA 11", "CHELSEA 15",
        "CHELSEA 19", "CHELSEA 21", "FLORIDA EVENING", "FLORIDA MIDDAY", "HOKIDRAW",
        "HONGKONG", "HUAHIN 0100", "HUAHIN 1630", "HUAHIN 2100", "JAKARTA 1400",
        "JAKARTA 2330", "KENTUCKY EVENING", "KENTUCKY MIDDAY", "KINGKONG 4D MALAM",
        "KINGKONG 4D SORE", "MAGNUM4D", "NEVADA", "NEW YORK EVENING", "NEW YORK MIDDAY",
        "NORTH CAROLINA DAY", "OREGON 03", "OREGON 06", "OREGON 09", "OREGON 12",
        "PCSO", "POIPET 12", "POIPET 15", "POIPET 19", "POIPET 22", "SINGAPORE",
        "SYDNEY", "TOTO CAMBODIA", "TOTO MACAU 5D MALAM", "TOTO MACAU 5D SORE",
        "TOTO MACAU MALAM I", "TOTO MACAU MALAM II", "TOTO MACAU MALAM III",
        "TOTO MACAU PAGI", "TOTO MACAU SIANG", "TOTO MACAU SORE", "TOTO MALI 1530",
        "TOTO MALI 2030", "TOTO MALI 2330"
      ],
      SHIO: [
        "Tikus", "Kerbau", "Harimau", "Kelinci", "Naga",
        "Ular", "Kuda", "Kambing", "Monyet", "Ayam",
        "Anjing", "Babi"
      ],
      URUTAN_PASARAN: [
        "TOTO MACAU PAGI", "KENTUCKY MIDDAY", "FLORIDA MIDDAY", "HUAHIN 0100",
        "BANGKOK 0130", "NEW YORK MIDDAY", "NORTH CAROLINA DAY", "BRUNEI 02",
        "OREGON 03", "OREGON 06", "CALIFORNIA", "FLORIDA EVENING", "OREGON 09",
        "BANGKOK 0930", "NEW YORK EVENING", "KENTUCKY EVENING", "CAROLINA EVENING",
        "TOTO CAMBODIA", "CHELSEA 11", "OREGON 12", "BULLSEYE", "POIPET 12",
        "TOTO MACAU SIANG", "SYDNEY", "JAKARTA 1400", "BRUNEI 14", "CHELSEA 15",
        "TOTO MACAU 5D SORE", "POIPET 15", "TOTO MALI 1530", "TOTO MACAU SORE",
        "HUAHIN 1630", "KINGKONG 4D SORE", "SINGAPORE", "MAGNUM4D", "CHELSEA 19",
        "TOTO MACAU MALAM I", "POIPET 19", "PCSO", "TOTO MALI 2030", "HUAHIN 2100",
        "CHELSEA 21", "TOTO MACAU 5D MALAM", "NEVADA", "BRUNEI 21", "TOTO MACAU MALAM II",
        "POIPET 22", "HONGKONG", "TOTO MACAU MALAM III", "TOTO MALI 2330", "JAKARTA 2330",
        "KINGKONG 4D MALAM", "HOKIDRAW"
      ],
      GENERATOR: {
        FOUR_D: { jumlah: 4, digit: 4 },
        THREE_D: { jumlah: 4, digit: 3 },
        TWO_D: { jumlah: 10, digit: 2 },
        COLOK_BEBAS: { jumlah: 2, digit: 1 },
        COLOK_BEBAS_2D: { jumlah: 3, digit: 2 },
        TWIN: { jumlah: 3, digit: 2 },
        BBFS: {
          besarKecil: { digit: 7 },
          genapGanjil: { digit: 5 }
        },
        SHIO: { jumlah: 3 }
      }
    };

    // ==================== ELEMEN DOM ====================
    const outputElement = document.getElementById('prediction-output');
    const tombolGenerate = document.getElementById('generate-button');
    const teksGenerate = document.getElementById('generate-text');
    const loadingSpinner = document.getElementById('loading-spinner');
    const dropdownPasaran = document.getElementById('pasaran');
    const grupPasaran = document.getElementById('pasaran-group');
    const pesanError = document.getElementById('error-message');
    const tombolSalin = document.getElementById('copy-button');

    // ==================== FUNGSI UTILITAS ====================
    function generateAngka(digit, jumlah) {
      if (digit <= 0 || jumlah <= 0) return [];
      const hasil = [];
      const maxNumber = Math.pow(10, digit);
      const generatedNumbers = new Set();
      
      while (hasil.length < jumlah) {
        let randomNumber = Math.floor(Math.random() * maxNumber);
        let angkaString = String(randomNumber).padStart(digit, '0');
        
        // Pastikan tidak ada angka yang sama
        if (!generatedNumbers.has(angkaString)) {
          generatedNumbers.add(angkaString);
          hasil.push(angkaString);
        }
      }
      return hasil;
    }

    function generateAngkaKembar(jumlah, digit) {
      if (jumlah <= 0 || digit <= 0) return [];
      const hasil = [];
      const generatedNumbers = new Set();
      
      while (hasil.length < jumlah) {
        const digitKembar = Math.floor(Math.random() * 10).toString();
        const angkaKembar = digitKembar.repeat(digit);
        
        if (!generatedNumbers.has(angkaKembar)) {
          generatedNumbers.add(angkaKembar);
          hasil.push(angkaKembar);
        }
      }
      return hasil;
    }

    function generateShio(jumlah) {
      if (jumlah <= 0) return [];
      const hasil = [];
      const usedIndices = new Set();
      
      while (hasil.length < jumlah && hasil.length < Config.SHIO.length) {
        const randomIndex = Math.floor(Math.random() * Config.SHIO.length);
        if (!usedIndices.has(randomIndex)) {
          usedIndices.add(randomIndex);
          hasil.push(Config.SHIO[randomIndex]);
        }
      }
      return hasil;
    }

    function dapatkanTanggalHariIniFormatted() {
      const sekarang = new Date();
      const HARI = ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"];
      const BULAN = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
      
      const hari = HARI[sekarang.getDay()];
      const tanggal = sekarang.getDate();
      const bulan = BULAN[sekarang.getMonth()];
      const tahun = sekarang.getFullYear();
      
      return `${hari}, ${tanggal} ${bulan} ${tahun}`;
    }

    // ==================== FUNGSI PREDIKSI ====================
    function buatPrediksi(pasaran) {
      if (!Config.PASARAN.includes(pasaran)) {
        console.error(`Permintaan prediksi untuk pasaran tidak valid: '${pasaran}'`);
        return { error: `Pasaran '${pasaran}' tidak ditemukan dalam daftar konfigurasi.` };
      }

      const twinDigit = Config.GENERATOR.TWIN.digit || 2;

      return {
        pasaran: pasaran,
        tanggalFormatted: dapatkanTanggalHariIniFormatted(),
        bbfs: {
          besarKecil: generateAngka(Config.GENERATOR.BBFS.besarKecil.digit, 1)[0],
          genapGanjil: generateAngka(Config.GENERATOR.BBFS.genapGanjil.digit, 1)[0]
        },
        fourD: generateAngka(Config.GENERATOR.FOUR_D.digit, Config.GENERATOR.FOUR_D.jumlah),
        threeD: generateAngka(Config.GENERATOR.THREE_D.digit, Config.GENERATOR.THREE_D.jumlah),
        twoD: generateAngka(Config.GENERATOR.TWO_D.digit, Config.GENERATOR.TWO_D.jumlah),
        colokBebas: generateAngka(Config.GENERATOR.COLOK_BEBAS.digit, Config.GENERATOR.COLOK_BEBAS.jumlah),
        colokBebas2D: generateAngka(Config.GENERATOR.COLOK_BEBAS_2D.digit, Config.GENERATOR.COLOK_BEBAS_2D.jumlah),
        twin: generateAngkaKembar(Config.GENERATOR.TWIN.jumlah, twinDigit),
        shio: generateShio(Config.GENERATOR.SHIO.jumlah)
      };
    }

    function buatSemuaPrediksi() {
      const hasilPrediksi = [];
      const tanggalFormatted = dapatkanTanggalHariIniFormatted();

      Config.URUTAN_PASARAN.forEach(pasaran => {
        try {
          const prediksi = buatPrediksi(pasaran);
          if (!prediksi.error) {
            prediksi.tanggalFormatted = tanggalFormatted;
          }
          hasilPrediksi.push(prediksi);
        } catch (error) {
          console.error(`Kesalahan tak terduga saat membuat prediksi untuk ${pasaran}:`, error);
          hasilPrediksi.push({ 
            pasaran: pasaran, 
            error: `Kesalahan internal: ${error.message || 'Tidak diketahui'}` 
          });
        }
      });

      return hasilPrediksi;
    }

    // ==================== FUNGSI TAMPILAN ====================
    function showError(message) {
      pesanError.innerHTML = `<i class="fas fa-exclamation-triangle"></i> <strong>Error:</strong> ${message}`;
      pesanError.style.display = 'block';
      hidePredictionOutput();
    }

    function hideError() {
      pesanError.style.display = 'none';
      pesanError.innerHTML = '';
    }

    function showLoading() {
      loadingSpinner.style.display = 'inline-block';
      teksGenerate.innerHTML = 'Memproses';
      teksGenerate.innerHTML += '<span class="loading-dots"><span>.</span><span>.</span><span>.</span></span>';
      tombolGenerate.disabled = true;
      hidePredictionOutput();
      hideError();
    }

    function hideLoading() {
      loadingSpinner.style.display = 'none';
      teksGenerate.innerHTML = 'GENERATE PREDIKSI';
      tombolGenerate.disabled = false;
    }

    function showPredictionOutput() {
      outputElement.style.display = 'block';
      tombolSalin.style.display = 'block';
    }

    function hidePredictionOutput() {
      outputElement.style.display = 'none';
      tombolSalin.style.display = 'none';
      outputElement.innerHTML = '';
      delete outputElement.dataset.copyText;
      tombolSalin.innerHTML = '<i class="fas fa-copy" style="margin-right: 10px;"></i> <span>SALIN HASIL</span>';
      tombolSalin.classList.remove('copied');
    }

    function muatDaftarPasaranDropdown() {
      // Kosongkan dropdown terlebih dahulu
      dropdownPasaran.innerHTML = '<option value="" disabled selected>-- Pilih Pasaran --</option>';

      // Urutkan pasaran secara alfabetis untuk kemudahan pencarian
      const sortedPasaran = [...Config.PASARAN].sort();
      
      sortedPasaran.forEach(pasaran => {
        const option = document.createElement('option');
        option.value = pasaran;
        option.textContent = pasaran;
        dropdownPasaran.appendChild(option);
      });

      if (dropdownPasaran.options.length > 1) {
        dropdownPasaran.disabled = false;
        dropdownPasaran.selectedIndex = 0;
      } else {
        dropdownPasaran.options[0].text = '-- Gagal Memuat Pasaran --';
        dropdownPasaran.disabled = true;
        showError("Gagal memuat daftar pasaran. Silakan refresh halaman.");
      }
    }

    function buatBaris(label, value) {
      const baris = document.createElement('div');
      baris.className = 'prediction-row';

      const labelSpan = document.createElement('span');
      labelSpan.className = 'prediction-label';
      labelSpan.innerHTML = `<i class="fas fa-chevron-right"></i> ${label}:`;
      labelSpan.style.marginRight = '15px';

      const valueSpan = document.createElement('span');
      valueSpan.className = 'prediction-value';
      valueSpan.textContent = value;

      baris.appendChild(labelSpan);
      baris.appendChild(valueSpan);
      return baris;
    }

    function tampilkanPrediksiSingle(data) {
      hideLoading();
      if (data && data.error) {
        showError(data.error);
        return;
      }
      if (!data || !data.pasaran || !data.bbfs || !data.tanggalFormatted) {
        showError("Format data prediksi yang diterima tidak valid.");
        return;
      }

      outputElement.innerHTML = '';

      const header = document.createElement('div');
      header.className = 'prediction-header';
      const judul = document.createElement('h2');
      judul.innerHTML = `PREDIKSI ${data.pasaran.toUpperCase()}`;
      const tanggal = document.createElement('div');
      tanggal.className = 'date';
      tanggal.innerHTML = `Tanggal: ${data.tanggalFormatted}`;
      header.appendChild(judul);
      header.appendChild(tanggal);
      outputElement.appendChild(header);

      outputElement.appendChild(buatBaris('BBFS', data.bbfs.besarKecil));
      outputElement.appendChild(buatBaris('AM/AI/CK', data.bbfs.genapGanjil));

      const pembatas1 = document.createElement('div');
      pembatas1.className = 'prediction-divider';
      outputElement.appendChild(pembatas1);

      outputElement.appendChild(buatBaris('4D', data.fourD.join(' ')));
      outputElement.appendChild(buatBaris('3D', data.threeD.join(' ')));
      outputElement.appendChild(buatBaris('2D (BB)', data.twoD.join(' ')));

      const pembatas2 = document.createElement('div');
      pembatas2.className = 'prediction-divider';
      outputElement.appendChild(pembatas2);

      outputElement.appendChild(buatBaris('COLOK BEBAS', data.colokBebas.join(' / ')));
      outputElement.appendChild(buatBaris('COLOK BEBAS 2D', data.colokBebas2D.join(' / ')));
      outputElement.appendChild(buatBaris('TWIN', data.twin.join(' / ')));
      outputElement.appendChild(buatBaris('SHIO', data.shio.join(' / ')));

      const footer = document.createElement('div');
      footer.className = 'prediction-footer';
      footer.innerHTML = 'Selalu Utamakan Prediksi Sendiri';
      outputElement.appendChild(footer);

      outputElement.dataset.copyText = buatTeksSalinSingle(data);
      showPredictionOutput();
    }

    function tampilkanSemuaPrediksiAll(dataArray) {
      hideLoading();
      if (!dataArray || !Array.isArray(dataArray)) {
        showError("Tidak ada data prediksi yang diterima atau format tidak valid.");
        return;
      }

      outputElement.innerHTML = '';
      let teksSalin = '';
      let firstSuccessfulDate = null;

      const headerAll = document.createElement('div');
      headerAll.className = 'prediction-header';
      const judulAll = document.createElement('h2');
      judulAll.innerHTML = 'PREDIKSI SEMUA PASARAN';

      const successfulPredictions = dataArray.filter(data => data && !data.error);
      const failedPredictions = dataArray.filter(data => data && data.error);

      if (successfulPredictions.length > 0) {
        firstSuccessfulDate = successfulPredictions[0].tanggalFormatted;
        const tanggalAll = document.createElement('div');
        tanggalAll.className = 'date';
        tanggalAll.innerHTML = `Tanggal: ${firstSuccessfulDate}`;
        headerAll.appendChild(judulAll);
        headerAll.appendChild(tanggalAll);
        outputElement.appendChild(headerAll);

        teksSalin += `PREDIKSI SEMUA PASARAN\n`;
        teksSalin += `Tanggal: ${firstSuccessfulDate}\n\n`;
      } else {
        headerAll.appendChild(judulAll);
        outputElement.appendChild(headerAll);
        teksSalin = "Tidak ada prediksi yang berhasil dihasilkan.";
      }

      successfulPredictions.forEach((prediksi, index) => {
        const pasaranBlock = document.createElement('div');
        pasaranBlock.className = 'pasaran-block';

        const judulPasaran = document.createElement('h3');
        judulPasaran.innerHTML = `PREDIKSI ${prediksi.pasaran}`;
        pasaranBlock.appendChild(judulPasaran);

        const tanggalPasaran = document.createElement('div');
        tanggalPasaran.className = 'date';
        tanggalPasaran.style.marginBottom = '12px'; /* Dikurangi dari 15px */
        tanggalPasaran.innerHTML = `Tanggal: ${prediksi.tanggalFormatted}`;
        pasaranBlock.appendChild(tanggalPasaran);

        const pemisahJudul = document.createElement('div');
        pemisahJudul.className = 'prediction-divider inside-block';
        pasaranBlock.appendChild(pemisahJudul);

        pasaranBlock.appendChild(buatBaris('BBFS', prediksi.bbfs.besarKecil));
        pasaranBlock.appendChild(buatBaris('AM/AI/CK', prediksi.bbfs.genapGanjil));

        const pembatas1 = document.createElement('div');
        pembatas1.className = 'prediction-divider inside-block';
        pasaranBlock.appendChild(pembatas1);

        pasaranBlock.appendChild(buatBaris('4D', prediksi.fourD.join(' ')));
        pasaranBlock.appendChild(buatBaris('3D', prediksi.threeD.join(' ')));
        pasaranBlock.appendChild(buatBaris('2D (BB)', prediksi.twoD.join(' ')));

        const pembatas2 = document.createElement('div');
        pembatas2.className = 'prediction-divider inside-block';
        pasaranBlock.appendChild(pembatas2);

        pasaranBlock.appendChild(buatBaris('COLOK BEBAS', prediksi.colokBebas.join(' / ')));
        pasaranBlock.appendChild(buatBaris('COLOK BEBAS 2D', prediksi.colokBebas2D.join(' / ')));
        pasaranBlock.appendChild(buatBaris('TWIN', prediksi.twin.join(' / ')));
        pasaranBlock.appendChild(buatBaris('SHIO', prediksi.shio.join(' / ')));

        const footerPasaran = document.createElement('div');
        footerPasaran.className = 'prediction-footer';
        footerPasaran.innerHTML = 'Selalu Utamakan Prediksi Sendiri';
        pasaranBlock.appendChild(footerPasaran);

        outputElement.appendChild(pasaranBlock);

        // Format teks salin tanpa tanda ===
        teksSalin += `PREDIKSI ${prediksi.pasaran}\n`;
        teksSalin += `Tanggal: ${prediksi.tanggalFormatted}\n`;
        teksSalin += `BBFS: ${prediksi.bbfs.besarKecil}\n`;
        teksSalin += `AM/AI/CK: ${prediksi.bbfs.genapGanjil}\n`;
        teksSalin += `4D: ${prediksi.fourD.join(' ')}\n`;
        teksSalin += `3D: ${prediksi.threeD.join(' ')}\n`;
        teksSalin += `2D (BB): ${prediksi.twoD.join(' ')}\n`;
        teksSalin += `COLOK BEBAS: ${prediksi.colokBebas.join(' / ')}\n`;
        teksSalin += `COLOK BEBAS 2D: ${prediksi.colokBebas2D.join(' / ')}\n`;
        teksSalin += `TWIN: ${prediksi.twin.join(' / ')}\n`;
        teksSalin += `SHIO: ${prediksi.shio.join(' / ')}\n`;
        teksSalin += `Selalu Utamakan Prediksi Sendiri\n`;
        if (index < successfulPredictions.length - 1) {
          teksSalin += "\n";
        }
      });

      if (failedPredictions.length > 0) {
        if (successfulPredictions.length > 0) {
          const errorDivider = document.createElement('div');
          errorDivider.className = 'prediction-divider';
          errorDivider.style.margin = '15px 0 8px 0'; /* Dikurangi dari 20px 0 10px 0 */
          outputElement.appendChild(errorDivider);
        }

        const errorHeader = document.createElement('h3');
        errorHeader.style.color = 'var(--danger)';
        errorHeader.style.margin = '12px 0 6px'; /* Dikurangi dari 15px 0 8px */
        errorHeader.innerHTML = '<i class="fas fa-exclamation-circle"></i> Gagal Menghasilkan Untuk Pasaran:';
        outputElement.appendChild(errorHeader);

        failedPredictions.forEach(fail => {
          const errorItem = document.createElement('p');
          errorItem.style.color = 'var(--danger)';
          errorItem.style.marginBottom = '5px'; /* Dikurangi dari 6px */
          errorItem.style.paddingLeft = '20px';
          errorItem.innerHTML = `<i class="fas fa-times-circle"></i> <strong>${fail.pasaran}:</strong> ${fail.error || 'Kesalahan tidak diketahui'}`;
          outputElement.appendChild(errorItem);
        });
      }

      outputElement.dataset.copyText = teksSalin;
      showPredictionOutput();
    }

    function buatTeksSalinSingle(data) {
      return `PREDIKSI ${data.pasaran}\n` +
        `Tanggal: ${data.tanggalFormatted}\n` +
        `BBFS: ${data.bbfs.besarKecil}\n` +
        `AM/AI/CK: ${data.bbfs.genapGanjil}\n` +
        `4D: ${data.fourD.join(' ')}\n` +
        `3D: ${data.threeD.join(' ')}\n` +
        `2D (BB): ${data.twoD.join(' ')}\n` +
        `COLOK BEBAS: ${data.colokBebas.join(' / ')}\n` +
        `COLOK BEBAS 2D: ${data.colokBebas2D.join(' / ')}\n` +
        `TWIN: ${data.twin.join(' / ')}\n` +
        `SHIO: ${data.shio.join(' / ')}\n` +
        `Selalu Utamakan Prediksi Sendiri`;
    }

    function salinPrediksi() {
      const teksUntukDisalin = outputElement.dataset.copyText;
      if (!teksUntukDisalin) {
        console.warn("Tidak ada teks untuk disalin.");
        showError("Tidak ada hasil prediksi untuk disalin.");
        return;
      }

      navigator.clipboard.writeText(teksUntukDisalin).then(() => {
        console.log('Teks berhasil disalin!');
        tombolSalin.innerHTML = '<i class="fas fa-check" style="margin-right: 10px;"></i> <span>Berhasil Disalin!</span>';
        tombolSalin.classList.add('copied');

        // Reset tombol setelah 2 detik
        setTimeout(() => {
          tombolSalin.innerHTML = '<i class="fas fa-copy" style="margin-right: 10px;"></i> <span>SALIN HASIL</span>';
          tombolSalin.classList.remove('copied');
        }, 2000);
      }).catch(err => {
        console.error('Gagal menyalin teks: ', err);
        
        // Fallback untuk browser lama
        const textArea = document.createElement('textarea');
        textArea.value = teksUntukDisalin;
        document.body.appendChild(textArea);
        textArea.select();
        try {
          document.execCommand('copy');
          alert("Hasil prediksi berhasil disalin!");
        } catch (copyErr) {
          showError("Gagal menyalin otomatis. Silakan salin manual dari teks di atas.");
        }
        document.body.removeChild(textArea);
      });
    }

    function toggleDropdownPasaran() {
      const jenisPrediksi = document.getElementById('prediction-type').value;
      const pasaranLabel = document.querySelector('#pasaran-group label');
      
      if (jenisPrediksi === 'all') {
        grupPasaran.style.display = 'none';
        dropdownPasaran.removeAttribute('required');
      } else {
        grupPasaran.style.display = 'block';
        dropdownPasaran.setAttribute('required', '');
        
        // Tambahkan efek transisi
        grupPasaran.style.animation = 'fadeIn 0.5s ease';
      }
      hidePredictionOutput();
      hideError();
    }

    function validasiInput() {
      const jenisPrediksi = document.getElementById('prediction-type').value;
      hideError();
      
      if (jenisPrediksi === 'single') {
        if (!dropdownPasaran.value || dropdownPasaran.value === '') {
          dropdownPasaran.classList.add('shake');
          setTimeout(() => {
            dropdownPasaran.classList.remove('shake');
          }, 500);
          showError("Mohon pilih pasaran terlebih dahulu.");
          return false;
        }
      }
      return true;
    }

    function generatePrediksi() {
      if (!validasiInput()) {
        return;
      }

      const jenisPrediksi = document.getElementById('prediction-type').value;
      showLoading();

      // Simulasi proses loading
      setTimeout(() => {
        try {
          if (jenisPrediksi === 'single') {
            const pasaranTerpilih = dropdownPasaran.value;
            console.log(`Membuat prediksi untuk: ${pasaranTerpilih}`);
            const prediksi = buatPrediksi(pasaranTerpilih);
            tampilkanPrediksiSingle(prediksi);
          } else {
            console.log("Membuat semua prediksi");
            const semuaPrediksi = buatSemuaPrediksi();
            tampilkanSemuaPrediksiAll(semuaPrediksi);
          }
        } catch (error) {
          console.error("Error saat membuat prediksi:", error);
          showError(`Terjadi kesalahan: ${error.message || 'Tidak diketahui'}`);
        } finally {
          hideLoading();
        }
      }, 800); // Tambah sedikit delay untuk efek loading yang lebih natural
    }

    // ==================== INISIALISASI ====================
    document.addEventListener('DOMContentLoaded', function() {
      console.log("Aplikasi Prediksi Togel diinisialisasi...");
      
      // Inisialisasi dropdown pasaran
      muatDaftarPasaranDropdown();
      
      // Event Listeners
      document.getElementById('prediction-type').addEventListener('change', toggleDropdownPasaran);
      document.getElementById('generate-button').addEventListener('click', generatePrediksi);
      document.getElementById('copy-button').addEventListener('click', salinPrediksi);
      
      // Tambahkan event untuk enter key
      document.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          generatePrediksi();
        }
      });
      
      // Set default view
      toggleDropdownPasaran();
      
      // Tampilkan pesan selamat datang
      console.log("Aplikasi siap digunakan. Pilih jenis prediksi dan klik Generate!");
    });
  </script>
</body>
</html>