<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <title>Memo Line</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=Noto+Serif+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
  <!-- Add Font Awesome for additional icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #ff4d89;
      --secondary-color: #ff8e53;
      --accent-color: #00e5ff;
      --dark-color: #0f0e17;
      --darker-color: #08070f;
      --light-color: #fffffe;
      --border-color: rgba(255, 255, 255, 0.1);
      --success-color: #00c897;
      --error-color: #ff4d4d;
      --text-primary: #e3e3e3;
      --text-secondary: #b8b8b8;
      --gold-accent: #ffd700;
      --red-accent: #ff2e63;
      --sidebar-icon-color: #ff8e53;
      --sidebar-active-icon-color: #ffd700;
      --panel-transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }
    
    body {
      font-family: 'Noto Sans SC', 'Noto Serif JP', sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      height: 100vh;
      overflow: hidden;
      background: var(--darker-color);
      color: var(--text-primary);
      line-height: 1.6;
    }
    
    /* Enhanced Sidebar Kanan */
    .sidebar {
      width: 300px;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      height: 100vh;
      overflow-y: auto;
      padding: 25px 20px;
      box-sizing: border-box;
      border-left: 1px solid var(--border-color);
      position: relative;
      z-index: 10;
      box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
      transition: var(--panel-transition);
    }
    
    .sidebar-header {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 30px;
      color: var(--light-color);
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
      font-family: 'Noto Serif JP', serif;
      display: flex;
      align-items: center;
      letter-spacing: 1px;
    }
    
    .sidebar-header i {
      margin-right: 12px;
      color: var(--sidebar-icon-color);
      font-size: 22px;
    }
    
    .sidebar-item {
      padding: 16px 20px 16px 55px;
      margin-bottom: 12px;
      background: rgba(15, 14, 23, 0.7);
      border-radius: 8px;
      cursor: pointer;
      color: var(--text-primary);
      font-weight: 400;
      border-left: 4px solid transparent;
      border: 1px solid var(--border-color);
      position: relative;
      transition: var(--panel-transition);
      font-size: 14px;
      letter-spacing: 0.5px;
    }
    
    .sidebar-item:hover {
      background: rgba(255, 46, 99, 0.15);
      border-left: 4px solid var(--red-accent);
      transform: translateX(5px);
    }
    
    .sidebar-item.active {
      background: rgba(255, 46, 99, 0.3);
      color: white;
      border-left: 4px solid var(--gold-accent);
      box-shadow: 0 5px 15px rgba(255, 46, 99, 0.2);
    }
    
    /* Icon styling for sidebar items */
    .sidebar-item::before {
      content: '';
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--sidebar-icon-color);
      font-size: 16px;
    }
    
    .sidebar-item.active::before {
      color: var(--sidebar-active-icon-color);
    }
    
    /* Specific icons for each memo type */
    .sidebar-item[data-sheet="MEMO PEMBAGIAN BONUS"]::before {
      content: '\f51e'; /* Money bill wave icon */
    }
    
    .sidebar-item[data-sheet="MEMO INFORMASI BANK"]::before {
      content: '\f19c'; /* Bank icon */
    }
    
    .sidebar-item[data-sheet="MEMO KENDALA PERMAINAN"]::before {
      content: '\f11b'; /* Gamepad icon */
    }
    
    .sidebar-item[data-sheet="MEMO KENDALA SISTEM"]::before {
      content: '\f085'; /* Cog icon */
    }
    
    .sidebar-item[data-sheet="REPORT KENDALA ALL SITUS"]::before {
      content: '\f0ac'; /* Globe icon */
    }
    
    .sidebar-item[data-sheet="REPORT KENDALA LINETOGEL"]::before {
      content: '\f542'; /* Laptop code icon */
    }

    /* Add subtle glow effect for active item */
    .sidebar-item.active::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
      pointer-events: none;
    }
    
    /* Section styling for sidebar */
    .sidebar-section {
      margin-bottom: 25px;
    }
    
    .sidebar-section-header {
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 15px;
      color: var(--accent-color);
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    
    .sidebar-section-header i {
      margin-right: 10px;
      font-size: 16px;
    }
    
    /* Konten Utama */
    .main-content {
      flex: 1;
      display: flex;
      overflow: hidden;
      background: var(--dark-color);
    }
    
    /* Bagian Kiri - Daftar Judul */
    .left-panel {
      width: 280px;
      height: 100vh;
      overflow-y: auto;
      padding: 25px 20px;
      box-sizing: border-box;
      background: #1a1a2e;
      border-right: 1px solid var(--border-color);
      position: relative;
      transition: var(--panel-transition);
    }
    
    .left-panel-header {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 25px;
      color: var(--light-color);
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
      font-family: 'Noto Serif JP', serif;
      letter-spacing: 1px;
    }
    
    .title-item {
      padding: 14px 16px;
      margin-bottom: 10px;
      background: rgba(15, 14, 23, 0.7);
      border-radius: 8px;
      cursor: pointer;
      border: 1px solid var(--border-color);
      color: var(--text-primary);
      font-weight: 400;
      transition: var(--panel-transition);
      font-size: 14px;
    }
    
    .title-item:hover {
      background: rgba(0, 232, 255, 0.1);
      border-left: 4px solid var(--accent-color);
      transform: translateX(3px);
    }
    
    /* Bagian Tengah - Tabel */
    .center-panel {
      flex: 1;
      padding: 30px;
      overflow-y: auto;
      box-sizing: border-box;
      background: var(--dark-color);
      position: relative;
      z-index: 1;
    }
    
    /* Tabel */
    .info-table {
      width: 100%;
      margin-top: 25px;
      border-collapse: separate;
      border-spacing: 0;
      border-radius: 10px;
      overflow: hidden;
      background: rgba(15, 14, 23, 0.7);
      border: 1px solid var(--border-color);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .info-table th {
      background: rgba(255, 46, 99, 0.7);
      color: white;
      padding: 16px;
      text-align: left;
      font-weight: 600;
      border: none;
      font-size: 14px;
      letter-spacing: 0.5px;
    }
    
    .info-table td {
      padding: 16px;
      border-bottom: 1px solid var(--border-color);
      background: rgba(15, 14, 23, 0.5);
      color: var(--text-primary);
      font-size: 14px;
      vertical-align: top;
    }
    
    .info-table tr:last-child td {
      border-bottom: none;
    }
    
    .info-table tr:hover td {
      background: rgba(255, 255, 255, 0.05);
    }
    
    .info-table tr:nth-child(even) td {
      background-color: rgba(15, 14, 23, 0.7);
    }
    
    .copy-btn {
      background: rgba(255, 46, 99, 0.8);
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 50px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      font-size: 13px;
      min-width: 90px;
      transition: var(--panel-transition);
    }
    
    .copy-btn:hover {
      background: rgba(255, 46, 99, 1);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(255, 46, 99, 0.3);
    }
    
    .copy-btn i {
      margin-right: 6px;
      font-size: 16px;
    }
    
    /* Section Headers */
    h3 {
      color: var(--light-color);
      margin-top: 35px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
      font-weight: 600;
      font-family: 'Noto Serif JP', serif;
      font-size: 18px;
      letter-spacing: 0.5px;
    }
    
    /* Alert */
    .alert {
      position: fixed;
      top: 25px;
      right: 25px;
      padding: 15px 25px;
      background: var(--success-color);
      color: white;
      border-radius: 8px;
      display: flex;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease, transform 0.3s ease;
      font-weight: 500;
      max-width: 350px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transform: translateY(-20px);
    }
    
    .alert.show {
      opacity: 1;
      transform: translateY(0);
    }
    
    .alert i {
      margin-right: 10px;
      font-size: 20px;
    }
    
    .alert.error {
      background: var(--error-color);
    }
    
    /* Scrollbar Styling */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.1);
      border-radius: 5px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: var(--red-accent);
      border-radius: 5px;
    }
    
    /* Left Panel Search */
    .left-search-container {
      margin-bottom: 20px;
      position: relative;
    }
    
    .left-search-input {
      width: 100%;
      padding: 12px 18px;
      border: 1px solid var(--border-color);
      border-radius: 50px;
      font-size: 13px;
      box-sizing: border-box;
      background: rgba(15, 14, 23, 0.7);
      color: var(--text-primary);
      transition: var(--panel-transition);
      padding-left: 40px;
    }
    
    .left-search-input::placeholder {
      color: var(--text-secondary);
    }
    
    .left-search-input:focus {
      outline: none;
      border-color: var(--accent-color);
      background: rgba(15, 14, 23, 0.9);
      box-shadow: 0 0 0 2px rgba(0, 229, 255, 0.2);
    }
    
    .search-icon {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-secondary);
      font-size: 14px;
    }
    
    /* Responsive Adjustments */
    @media (max-width: 1200px) {
      .left-panel, .sidebar {
        width: 250px;
      }
      
      .center-panel {
        padding: 20px;
      }
    }

    /* New style for empty state */
    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 60vh;
      color: var(--text-secondary);
      text-align: center;
      padding: 0 20px;
    }

    .empty-state i {
      font-size: 60px;
      margin-bottom: 20px;
      color: var(--border-color);
      opacity: 0.7;
    }

    .empty-state p {
      font-size: 16px;
      max-width: 400px;
      line-height: 1.6;
      margin: 0;
    }
    
    /* Enhanced table content styling */
    .table-content {
      white-space: pre-wrap;
      word-break: break-word;
    }
    
    /* Smooth transitions for panel interactions */
    .title-item, .sidebar-item, .copy-btn {
      transition: var(--panel-transition);
    }
    
    /* Subtle hover effect for tables */
    .info-table tr {
      transition: background-color 0.2s ease;
    }
    
    /* Improved focus states for accessibility */
    button:focus, input:focus {
      outline: none;
      box-shadow: 0 0 0 2px var(--accent-color);
    }
    
    /* Loading indicator */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: var(--accent-color);
      animation: spin 1s ease-in-out infinite;
      margin-left: 10px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Loading overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(15, 14, 23, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      flex-direction: column;
      color: var(--accent-color);
      font-size: 18px;
    }

    .loading-overlay.hidden {
      display: none;
    }

    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 5px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      border-top-color: var(--accent-color);
      animation: spin 1s ease-in-out infinite;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loading-overlay">
    <div class="loading-spinner"></div>
    <div>Loading data from Google Sheets...</div>
  </div>

  <!-- Bagian Utama -->
  <div class="main-content">
    <!-- Panel Kiri - Daftar Judul -->
    <div class="left-panel">
      <div class="left-panel-header">Ôº¨Ôº©Ôº≥Ôº¥ Ôº™ÔºµÔº§ÔºµÔº¨</div>
      <div class="left-search-container">
        <span class="search-icon">üîé</span>
        <input type="text" class="left-search-input" id="left-search-input" placeholder="Cari judul...">
      </div>
      <div id="title-list"></div>
    </div>
    
    <!-- Panel Tengah - Tabel -->
    <div class="center-panel">
      <!-- Initially show empty state -->
      <div class="empty-state" id="empty-state">
        <i class="fas fa-file-alt"></i>
        <p>Pilih judul dari list sebelah kiri untuk melihat detail memo</p>
      </div>
      
      <!-- Tables (hidden by default) -->
      <div id="tables-container" style="display: none;">
        <!-- Tabel Judul -->
        <h3>Title</h3>
        <table class="info-table" id="title-table">
          <thead>
            <tr>
              <th>Judul</th>
              <th width="140px">Aksi</th>
            </tr>
          </thead>
          <tbody id="title-table-body"></tbody>
        </table>
        
        <!-- Tabel Isi -->
        <h3 style="margin-top: 35px;">Description</h3>
        <table class="info-table" id="content-table">
          <thead>
            <tr>
              <th>Isi</th>
              <th width="140px">Aksi</th>
            </tr>
          </thead>
          <tbody id="content-table-body"></tbody>
        </table>
      </div>
    </div>

    <!-- Enhanced Sidebar Kanan -->
    <div class="sidebar">
      <div class="sidebar-header">
        <i class="fas fa-clipboard-list"></i>
        Ôº¨Ôº©Ôº≥Ôº¥ Ôº≠Ôº•Ôº≠ÔºØ
      </div>
      
      <!-- Section 1: Memo Utama -->
      <div class="sidebar-section">
        <div class="sidebar-section-header">
          <i class="fas fa-sticky-note"></i>
          MEMO UTAMA
        </div>
        <div class="sidebar-item active" data-sheet="MEMO PEMBAGIAN BONUS">MEMO PEMBAGIAN BONUS</div>
        <div class="sidebar-item" data-sheet="MEMO INFORMASI BANK">MEMO INFORMASI BANK</div>
        <div class="sidebar-item" data-sheet="MEMO KENDALA PERMAINAN">MEMO KENDALA PERMAINAN</div>
        <div class="sidebar-item" data-sheet="MEMO KENDALA SISTEM">MEMO KENDALA SISTEM</div>
      </div>
      
      <!-- Section 2: Report Kendala Situs -->
      <div class="sidebar-section">
        <div class="sidebar-section-header">
          <i class="fas fa-globe"></i>
          REPORT KENDALA SITUS
        </div>
        <div class="sidebar-item" data-sheet="REPORT KENDALA ALL SITUS">REPORT KENDALA ALL SITUS</div>
      </div>
      
      <!-- Section 3: Report LineTogel -->
      <div class="sidebar-section">
        <div class="sidebar-section-header">
          <i class="fas fa-laptop-code"></i>
          REPORT LINETOGEL
        </div>
        <div class="sidebar-item" data-sheet="REPORT KENDALA LINETOGEL">REPORT KENDALA LINETOGEL</div>
      </div>
    </div>
  </div>
  
  <!-- Alert -->
  <div class="alert" id="alert">
    <i class="material-icons">check_circle</i>
    <span id="alert-message">„ÉÜ„Ç≠„Çπ„Éà„Åå„Ç≥„Éî„Éº„Åï„Çå„Åæ„Åó„Åü!</span>
  </div>
  
  <script>
    // Google Sheets API configuration
    const SPREADSHEET_ID = '1V9rNIOgLHxY73Ud1WBHhZCBZqXqTR9ZTLiedwvL5FJ4';
    const API_KEY = ''; // You'll need to add your Google Sheets API key here
    const SHEETS = {
      'MEMO PEMBAGIAN BONUS': 0,
      'MEMO INFORMASI BANK': 0, // DIUBAH: Menggunakan 0 agar menggunakan nama sheet
      'MEMO KENDALA PERMAINAN': 0,
      'MEMO KENDALA SISTEM': 0,
      'REPORT KENDALA ALL SITUS': 0,
      'REPORT KENDALA LINETOGEL': 0
    };

    document.addEventListener('DOMContentLoaded', function() {
      const sidebarItems = document.querySelectorAll('.sidebar-item');
      const leftSearchInput = document.getElementById('left-search-input');
      const titleList = document.getElementById('title-list');
      const titleTableBody = document.getElementById('title-table-body');
      const contentTableBody = document.getElementById('content-table-body');
      const alertBox = document.getElementById('alert');
      const alertMessage = document.getElementById('alert-message');
      const emptyState = document.getElementById('empty-state');
      const tablesContainer = document.getElementById('tables-container');
      const loadingOverlay = document.getElementById('loading-overlay');
      
      let allData = {};
      let currentSheet = 'MEMO PEMBAGIAN BONUS';
      let currentData = [];
      
      // Show loading overlay
      loadingOverlay.classList.remove('hidden');
      
      // Load data from Google Sheets
      loadAllSheetData();
      
      // Handle klik sidebar
      sidebarItems.forEach(item => {
        item.addEventListener('click', function() {
          sidebarItems.forEach(i => i.classList.remove('active'));
          this.classList.add('active');
          currentSheet = this.getAttribute('data-sheet');
          loadSheetData(currentSheet);

          // Sembunyikan tabel dan tampilkan empty state saat memilih kategori baru
          tablesContainer.style.display = 'none';
          emptyState.style.display = 'flex';
        });
      });

      // Function to load all sheet data
      async function loadAllSheetData() {
        try {
          const promises = Object.keys(SHEETS).map(sheetName => 
            loadSheetFromGoogleSheets(sheetName)
          );
          
          const results = await Promise.all(promises);
          
          // Combine all results into allData object
          Object.keys(SHEETS).forEach((sheetName, index) => {
            allData[sheetName] = results[index];
          });
          
          // Hide loading overlay
          loadingOverlay.classList.add('hidden');
          
          // Load initial sheet data
          loadSheetData(currentSheet);
          
        } catch (error) {
          console.error('Error loading data:', error);
          showAlert('Gagal memuat data dari Google Sheets', 'error');
          loadingOverlay.classList.add('hidden');
        }
      }
      
      // Function to load data from Google Sheets for a specific sheet
      async function loadSheetFromGoogleSheets(sheetName) {
        const gid = SHEETS[sheetName];
        let url = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json`;
        
        // PENAMBAHAN: Logika khusus untuk MEMO INFORMASI BANK
        if (sheetName === "MEMO INFORMASI BANK") {
          console.log(`Mencoba memuat data untuk: ${sheetName}`);
          
          // Coba metode alternatif terlebih dahulu untuk MEMO INFORMASI BANK
          try {
            const alternativeData = await tryAlternativeMethodForBankInfo();
            if (alternativeData && alternativeData.length > 0) {
              console.log(`Berhasil memuat data ${sheetName} dengan metode alternatif: ${alternativeData.length} item`);
              return alternativeData;
            }
          } catch (altError) {
            console.warn(`Metode alternatif gagal untuk ${sheetName}:`, altError);
          }
          
          // Jika metode alternatif gagal, coba metode standar
          url += `&sheet=${encodeURIComponent(sheetName)}`;
          console.log(`Menggunakan URL standar untuk ${sheetName}`);
        } else {
          // Untuk sheet lain, gunakan logika asli
          if (gid !== 0) {
            url += `&gid=${gid}`;
          } else {
            url += `&sheet=${encodeURIComponent(sheetName)}`;
          }
        }
        
        try {
          const response = await fetch(url);
          
          // Periksa apakah response valid
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          
          const text = await response.text();
          
          // Periksa apakah response kosong
          if (!text || text.trim().length === 0) {
            console.warn(`Response kosong untuk sheet: ${sheetName}`);
            return [];
          }
          
          // Parse the JSONP response
          const jsonText = text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1);
          const json = JSON.parse(jsonText);
          
          // Extract data from the response
          const sheetData = [];
          if (json.table && json.table.rows) {
            json.table.rows.forEach((row, index) => {
              // Skip header row (index 0) dan cek apakah row memiliki data
              if (index > 0 && row.c && row.c.length > 0) {
                // Ambil data kolom 1 sebagai judul
                const title = row.c[0] ? (row.c[0].v || '') : '';
                // Ambil data kolom 2 sebagai konten (jika ada)
                const content = row.c[1] ? (row.c[1].v || '') : '';
                
                if (title && title.toString().trim() !== '') {
                  sheetData.push({
                    title: title.toString(),
                    content: content.toString()
                  });
                }
              }
            });
          }
          
          console.log(`Data loaded for ${sheetName}:`, sheetData.length, "items");
          return sheetData;
        } catch (error) {
          console.error(`Error loading sheet ${sheetName}:`, error);
          
          // PENAMBAHAN: Untuk MEMO INFORMASI BANK, coba metode cadangan lain
          if (sheetName === "MEMO INFORMASI BANK") {
            console.log("Mencoba metode cadangan untuk MEMO INFORMASI BANK...");
            return tryAlternativeMethodForBankInfo();
          }
          
          return [];
        }
      }

      // PENAMBAHAN: Fungsi khusus untuk MEMO INFORMASI BANK
      async function tryAlternativeMethodForBankInfo() {
        try {
          console.log("Mencoba metode alternatif khusus untuk MEMO INFORMASI BANK");
          
          // Coba beberapa kemungkinan struktur URL
          const urlVariations = [
            // Coba dengan nama sheet yang berbeda (mungkin ada spasi atau format berbeda)
            `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&sheet=MEMO%20INFORMASI%20BANK`,
            `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&sheet=Memo%20Informasi%20Bank`,
            `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&sheet=Memo%20Informasi%20bank`,
            // Coba tanpa parameter sheet (mungkin sheet pertama atau default)
            `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json`
          ];
          
          for (let i = 0; i < urlVariations.length; i++) {
            try {
              const url = urlVariations[i];
              console.log(`Mencoba URL: ${url}`);
              
              const response = await fetch(url);
              if (!response.ok) continue;
              
              const text = await response.text();
              if (!text || text.trim().length === 0) continue;
              
              const jsonText = text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1);
              const json = JSON.parse(jsonText);
              
              // Cek apakah ini sheet yang kita cari
              if (json.table && json.table.rows && json.table.rows.length > 1) {
                // Cek baris pertama untuk konfirmasi apakah ini MEMO INFORMASI BANK
                const firstRow = json.table.rows[0];
                if (firstRow.c && firstRow.c[0] && firstRow.c[0].v) {
                  const firstCell = firstRow.c[0].v.toString().toUpperCase();
                  if (firstCell.includes("BANK") || firstCell.includes("INFORMASI")) {
                    console.log(`Found potential MEMO INFORMASI BANK data at variation ${i}`);
                  }
                }
                
                const sheetData = [];
                json.table.rows.forEach((row, index) => {
                  if (index > 0 && row.c && row.c[0] && row.c[0].v) {
                    const title = row.c[0].v;
                    const content = row.c[1] ? row.c[1].v : '';
                    
                    if (title.toString().trim() !== '') {
                      sheetData.push({
                        title: title.toString(),
                        content: content.toString()
                      });
                    }
                  }
                });
                
                if (sheetData.length > 0) {
                  console.log(`Berhasil memuat data dengan metode alternatif: ${sheetData.length} item`);
                  return sheetData;
                }
              }
            } catch (variationError) {
              console.log(`Variation ${i} gagal:`, variationError);
              continue;
            }
          }
          
          console.warn("Semua metode alternatif gagal untuk MEMO INFORMASI BANK");
          return [];
        } catch (altError) {
          console.error("Metode alternatif khusus gagal:", altError);
          return [];
        }
      }
      
      // Fungsi untuk memuat data sheet
      function loadSheetData(sheetName) {
        if (allData[sheetName]) {
          currentData = allData[sheetName];
          renderTitleList();
          // Clear tables when loading new sheet
          titleTableBody.innerHTML = '';
          contentTableBody.innerHTML = '';
          
          // PENAMBAHAN: Log untuk debugging
          console.log(`${sheetName} data loaded:`, currentData.length, "items");
        } else {
          currentData = [];
          renderTitleList();
          showAlert(`Data untuk ${sheetName} tidak ditemukan`, 'error');
          console.error(`Data ${sheetName} tidak ada di allData`);
        }
      }
      
      // Render daftar judul di panel kiri
      function renderTitleList() {
        titleList.innerHTML = '';
        
        if (currentData.length === 0) {
          const emptyDiv = document.createElement('div');
          emptyDiv.className = 'title-item';
          emptyDiv.textContent = 'Tidak ada data';
          emptyDiv.style.color = 'var(--text-secondary)';
          emptyDiv.style.fontStyle = 'italic';
          emptyDiv.style.cursor = 'default';
          titleList.appendChild(emptyDiv);
          return;
        }
        
        currentData.forEach((item, index) => {
          const div = document.createElement('div');
          div.className = 'title-item';
          div.textContent = item.title;
          div.addEventListener('click', () => {
            showItemDetails(index);
          });
          titleList.appendChild(div);
        });
      }
      
      // Tampilkan detail item di tabel
      function showItemDetails(index) {
        // Show tables and hide empty state
        tablesContainer.style.display = 'block';
        emptyState.style.display = 'none';
        
        titleTableBody.innerHTML = '';
        contentTableBody.innerHTML = '';
        
        const item = currentData[index];
        
        // Tabel Judul (hanya menampilkan 1 item yang dipilih)
        const titleRow = document.createElement('tr');
        titleRow.innerHTML = `
          <td class="table-content">${escapeHtml(item.title)}</td>
          <td>
            <button class="copy-btn" data-text="${cleanTextForCopy(item.title)}" data-type="Judul ">
              <i class="material-icons">content_copy</i> Copy
            </button>
          </td>
        `;
        titleTableBody.appendChild(titleRow);
        
        // Tabel Isi (hanya menampilkan 1 item yang dipilih)
        const contentRow = document.createElement('tr');
        contentRow.innerHTML = `
          <td class="table-content">${escapeHtml(item.content)}</td>
          <td>
            <button class="copy-btn" data-text="${cleanTextForCopy(item.content)}" data-type="Isi ">
              <i class="material-icons">content_copy</i> Copy
            </button>
          </td>
        `;
        contentTableBody.appendChild(contentRow);
        
        attachCopyListeners();
      }
      
      // Fungsi untuk membersihkan teks untuk disalin (tanpa <br>)
      function cleanTextForCopy(text) {
        if (!text) return '';
        // Hapus tag <br> dan ganti dengan newline
        return text.toString()
          .replace(/<br\s*\/?>/gi, '\n') // Ganti <br>, <br/>, <br /> dengan newline
          .replace(/&nbsp;/g, ' ') // Ganti &nbsp; dengan spasi
          .replace(/&amp;/g, "&")
          .replace(/&lt;/g, "<")
          .replace(/&gt;/g, ">")
          .replace(/&quot;/g, '"')
          .replace(/&#039;/g, "'");
      }
      
      // Fungsi untuk escape HTML (untuk tampilan)
      function escapeHtml(unsafe) {
        if (!unsafe) return '';
        return unsafe.toString()
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;")
          .replace(/\n/g, "<br>"); // Untuk tampilan, ganti newline dengan <br>
      }
      
      // Fungsi pencarian di panel kiri (untuk judul saja)
      leftSearchInput.addEventListener('input', function() {
        const query = this.value.toLowerCase();
        const titleItems = document.querySelectorAll('.title-item');
        
        titleItems.forEach(item => {
          const title = item.textContent.toLowerCase();
          if (title.includes(query)) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
      });
      
      // Attach event listeners to copy buttons
      function attachCopyListeners() {
        document.querySelectorAll('.copy-btn').forEach(btn => {
          // Remove any existing click handlers to prevent duplicates
          btn.replaceWith(btn.cloneNode(true));
        });
        
        document.querySelectorAll('.copy-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const text = this.getAttribute('data-text');
            const type = this.getAttribute('data-type');
            copyToClipboard(text, type);
          });
        });
      }
      
      // Global function to copy text
      window.copyToClipboard = function(text, type) {
        // Teks sudah dibersihkan dari tag <br> di fungsi cleanTextForCopy
        const cleanedText = text;
        
        navigator.clipboard.writeText(cleanedText).then(() => {
          showAlert(`${type}berhasil di Copy!`, 'success');
        }).catch(err => {
          console.error('Gagal menyalin teks: ', err);
          showAlert('Gagal menyalin teks!', 'error');
          
          // Fallback for browsers that don't support navigator.clipboard
          const textarea = document.createElement('textarea');
          textarea.value = cleanedText;
          document.body.appendChild(textarea);
          textarea.select();
          try {
            document.execCommand('copy');
            showAlert(`${type}berhasil di Copy!`, 'success');
          } catch (err) {
            console.error('Metode salin alternatif gagal: ', err);
            showAlert('Gagal menyalin teks!', 'error');
          }
          document.body.removeChild(textarea);
        });
      };
      
      // Function to show alert
      function showAlert(message, type = 'success') {
        alertMessage.textContent = message;
        alertBox.className = 'alert';
        alertBox.classList.add('show');
        if (type === 'error') {
          alertBox.classList.add('error');
        }
        
        setTimeout(() => {
          alertBox.classList.remove('show');
        }, 3000);
      }
    });
  </script>
</body>

</html>
