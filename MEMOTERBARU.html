<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <title>Memo Line</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=Noto+Serif+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
  <!-- Add Font Awesome for additional icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #6366f1;
      --secondary-color: #8b5cf6;
      --accent-color: #06b6d4;
      --dark-color: #0f172a;
      --darker-color: #020617;
      --light-color: #f8fafc;
      --border-color: rgba(148, 163, 184, 0.1);
      --success-color: #10b981;
      --error-color: #ef4444;
      --text-primary: #f1f5f9;
      --text-secondary: #94a3b8;
      --gold-accent: #f59e0b;
      --red-accent: #ef4444;
      --sidebar-icon-color: #64748b;
      --sidebar-active-icon-color: #f59e0b;
      --panel-transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-accent: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --orange-gradient: linear-gradient(135deg, #f59e0b 0%, #f97316 100%);
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Noto Sans SC', 'Noto Serif JP', sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      height: 100vh;
      overflow: hidden;
      background: var(--darker-color);
      color: var(--text-primary);
      line-height: 1.6;
      font-weight: 700;
    }
    
    /* Enhanced Sidebar Kanan */
    .sidebar {
      width: 280px;
      background: rgba(15, 23, 42, 0.8);
      backdrop-filter: blur(10px);
      height: 100vh;
      overflow-y: auto;
      padding: 20px 16px;
      box-sizing: border-box;
      border-left: 1px solid var(--border-color);
      position: relative;
      z-index: 10;
      box-shadow: var(--shadow-xl);
      transition: var(--panel-transition);
    }
    
    .sidebar-header {
      font-size: 18px;
      font-weight: 900;
      margin-bottom: 25px;
      color: var(--light-color);
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border-color);
      font-family: 'Noto Serif JP', serif;
      display: flex;
      align-items: center;
      letter-spacing: 1px;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    
    .sidebar-header i {
      margin-right: 10px;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-size: 20px;
    }
    
    .sidebar-item {
      padding: 14px 16px 14px 50px;
      margin-bottom: 10px;
      background: rgba(30, 41, 59, 0.5);
      border-radius: 10px;
      cursor: pointer;
      color: var(--text-primary);
      font-weight: 700;
      border: 1px solid var(--border-color);
      position: relative;
      transition: var(--panel-transition);
      font-size: 13px;
      letter-spacing: 0.5px;
      overflow: hidden;
    }
    
    .sidebar-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 0;
      height: 100%;
      background: var(--gradient-secondary);
      transition: width 0.3s ease;
      z-index: -1;
    }
    
    .sidebar-item:hover {
      transform: translateX(3px);
      border-color: var(--primary-color);
      box-shadow: var(--shadow-md);
    }
    
    .sidebar-item:hover::before {
      width: 100%;
    }
    
    .sidebar-item.active {
      background: rgba(99, 102, 241, 0.2);
      color: white;
      border: 1px solid var(--primary-color);
      box-shadow: var(--shadow-lg);
      font-weight: 900;
    }
    
    /* Icon styling for sidebar items */
    .sidebar-item::after {
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      position: absolute;
      left: 18px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--sidebar-icon-color);
      font-size: 14px;
      transition: color 0.3s ease;
    }
    
    .sidebar-item.active::after {
      color: var(--sidebar-active-icon-color);
    }
    
    /* Specific icons for each memo type */
    .sidebar-item[data-sheet="MEMO PEMBAGIAN BONUS"]::after {
      content: '\f51e';
    }
    
    .sidebar-item[data-sheet="MEMO INFORMASI BANK"]::after {
      content: '\f19c';
    }
    
    .sidebar-item[data-sheet="MEMO KENDALA PERMAINAN"]::after {
      content: '\f11b';
    }
    
    .sidebar-item[data-sheet="MEMO KENDALA SISTEM"]::after {
      content: '\f085';
    }
    
    .sidebar-item[data-sheet="REPORT KENDALA ALL SITUS"]::after {
      content: '\f0ac';
    }
    
    .sidebar-item[data-sheet="REPORT KENDALA LINETOGEL"]::after {
      content: '\f542';
    }
    
    /* Add subtle glow effect for active item */
    .sidebar-item.active {
      position: relative;
    }
    
    .sidebar-item.active::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 10px;
      background: rgba(99, 102, 241, 0.1);
      box-shadow: 0 0 15px rgba(99, 102, 241, 0.2);
      pointer-events: none;
      z-index: -1;
    }
    
    /* Section styling for sidebar */
    .sidebar-section {
      margin-bottom: 20px;
    }
    
    .sidebar-section-header {
      font-size: 12px;
      font-weight: 900;
      margin-bottom: 12px;
      color: var(--accent-color);
      padding-bottom: 6px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    
    .sidebar-section-header i {
      margin-right: 8px;
      font-size: 14px;
    }
    
    /* Konten Utama */
    .main-content {
      flex: 1;
      display: flex;
      overflow: hidden;
      background: var(--dark-color);
      position: relative;
      max-width: 100%;
    }
    
    /* Bagian Kiri - Daftar Judul */
    .left-panel {
      width: 260px;
      height: 100vh;
      overflow-y: auto;
      padding: 20px 16px;
      box-sizing: border-box;
      background: rgba(15, 23, 42, 0.6);
      backdrop-filter: blur(10px);
      border-right: 1px solid var(--border-color);
      position: relative;
      transition: var(--panel-transition);
    }
    
    .left-panel-header {
      font-size: 18px;
      font-weight: 900;
      margin-bottom: 20px;
      color: var(--light-color);
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border-color);
      font-family: 'Noto Serif JP', serif;
      letter-spacing: 1px;
      background: var(--gradient-accent);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    
    .title-item {
      padding: 12px 14px;
      margin-bottom: 8px;
      background: rgba(30, 41, 59, 0.5);
      border-radius: 10px;
      cursor: pointer;
      border: 1px solid var(--border-color);
      color: var(--text-primary);
      font-weight: 700;
      transition: var(--panel-transition);
      font-size: 13px;
      position: relative;
      overflow: hidden;
    }
    
    .title-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: var(--gradient-accent);
      transition: left 0.3s ease;
      z-index: -1;
    }
    
    .title-item:hover {
      transform: translateX(2px);
      border-color: var(--accent-color);
      box-shadow: var(--shadow-md);
      font-weight: 800;
    }
    
    .title-item:hover::before {
      left: 0;
    }
    
    /* Bagian Tengah - Tabel - YANG DIUBAH */
    .center-panel {
      flex: 1;
      max-width: 600px;
      padding: 20px;
      overflow-y: auto;
      box-sizing: border-box;
      background: var(--dark-color);
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      margin: 0 auto;
    }
    
    /* Tabel */
    .info-table {
      width: 100%;
      margin-top: 20px;
      border-collapse: separate;
      border-spacing: 0;
      border-radius: 12px;
      overflow: hidden;
      background: rgba(30, 41, 59, 0.5);
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-lg);
    }
    
    .info-table th {
      background: rgba(99, 102, 241, 0.8);
      color: white;
      padding: 12px;
      text-align: left;
      font-weight: 900;
      border: none;
      font-size: 13px;
      letter-spacing: 0.5px;
      position: relative;
    }
    
    .info-table th::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 1px;
      background: rgba(255, 255, 255, 0.1);
    }
    
    .info-table td {
      padding: 12px;
      border-bottom: 1px solid var(--border-color);
      background: rgba(15, 23, 42, 0.3);
      color: var(--text-primary);
      font-size: 13px;
      font-weight: 700;
      vertical-align: top;
      transition: background-color 0.2s ease;
    }
    
    .info-table tr:last-child td {
      border-bottom: none;
    }
    
    .info-table tr:hover td {
      background: rgba(99, 102, 241, 0.1);
      font-weight: 800;
    }
    
    .info-table tr:nth-child(even) td {
      background-color: rgba(30, 41, 59, 0.3);
    }
    
    .copy-btn {
      background: var(--gradient-primary);
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 50px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 12px;
      min-width: 80px;
      transition: var(--panel-transition);
      position: relative;
      overflow: hidden;
    }
    
    .copy-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.2);
      transition: left 0.3s ease;
    }
    
    .copy-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
      font-weight: 900;
    }
    
    .copy-btn:hover::before {
      left: 100%;
    }
    
    .copy-btn i {
      margin-right: 5px;
      font-size: 14px;
    }
    
    /* Section Headers */
    h3 {
      color: var(--light-color);
      margin-top: 30px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border-color);
      font-weight: 900;
      font-family: 'Noto Serif JP', serif;
      font-size: 16px;
      letter-spacing: 0.5px;
      position: relative;
      display: inline-block;
    }
    
    h3::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 50px;
      height: 2px;
      background: var(--gradient-primary);
    }
    
    /* Alert */
    .alert {
      position: fixed;
      top: 25px;
      right: 25px;
      padding: 12px 20px;
      background: rgba(16, 185, 129, 0.9);
      backdrop-filter: blur(10px);
      color: white;
      border-radius: 10px;
      display: flex;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease, transform 0.3s ease;
      font-weight: 800;
      max-width: 320px;
      box-shadow: var(--shadow-xl);
      transform: translateY(-20px);
    }
    
    .alert.show {
      opacity: 1;
      transform: translateY(0);
    }
    
    .alert i {
      margin-right: 8px;
      font-size: 18px;
    }
    
    .alert.error {
      background: rgba(239, 68, 68, 0.9);
    }
    
    /* Scrollbar Styling */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(15, 23, 42, 0.3);
      border-radius: 5px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: var(--primary-color);
      border-radius: 5px;
    }
    
    /* Left Panel Search */
    .left-search-container {
      margin-bottom: 16px;
      position: relative;
    }
    
    .left-search-input {
      width: 100%;
      padding: 10px 14px;
      padding-left: 35px;
      border: 1px solid var(--border-color);
      border-radius: 50px;
      font-size: 12px;
      font-weight: 700;
      box-sizing: border-box;
      background: rgba(30, 41, 59, 0.5);
      color: var(--text-primary);
      transition: var(--panel-transition);
    }
    
    .left-search-input::placeholder {
      color: var(--text-secondary);
      font-weight: 500;
    }
    
    .left-search-input:focus {
      outline: none;
      border-color: var(--accent-color);
      background: rgba(30, 41, 59, 0.8);
      box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.1);
      font-weight: 800;
    }
    
    .search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-secondary);
      font-size: 12px;
    }
    
    /* Responsive Adjustments */
    @media (max-width: 1200px) {
      .left-panel, .sidebar {
        width: 240px;
      }
      
      .center-panel {
        padding: 16px;
        max-width: 500px;
      }
      
      .bonus-header-container {
        flex-direction: column;
        align-items: flex-start !important;
        gap: 10px;
      }
      
      .bonus-title-section, .today-date-section {
        width: 100% !important;
      }
    }
    
    @media (max-width: 1024px) {
      .center-panel {
        max-width: 450px;
      }
    }

    /* New style for empty state */
    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 60vh;
      color: var(--text-secondary);
      text-align: center;
      padding: 0 20px;
    }

    .empty-state i {
      font-size: 50px;
      margin-bottom: 16px;
      color: var(--border-color);
      opacity: 0.7;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .empty-state p {
      font-size: 14px;
      font-weight: 700;
      max-width: 350px;
      line-height: 1.6;
      margin: 0;
    }
    
    /* Enhanced table content styling */
    .table-content {
      white-space: pre-wrap;
      word-break: break-word;
      font-weight: 700;
    }
    
    /* Smooth transitions for panel interactions */
    .title-item, .sidebar-item, .copy-btn {
      transition: var(--panel-transition);
    }
    
    /* Subtle hover effect for tables */
    .info-table tr {
      transition: background-color 0.2s ease;
    }
    
    /* Improved focus states for accessibility */
    button:focus, input:focus {
      outline: none;
      box-shadow: 0 0 0 2px var(--accent-color);
    }
    
    /* Loading indicator */
    .loading {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: var(--accent-color);
      animation: spin 1s ease-in-out infinite;
      margin-left: 8px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Loading overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(10px);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      flex-direction: column;
      color: var(--accent-color);
      font-size: 16px;
      font-weight: 800;
    }

    .loading-overlay.hidden {
      display: none;
    }

    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      border-top-color: var(--accent-color);
      animation: spin 1s ease-in-out infinite;
      margin-bottom: 16px;
    }
    
    /* Floating particles background effect */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: -1;
    }
    
    .particle {
      position: absolute;
      width: 3px;
      height: 3px;
      background: var(--primary-color);
      border-radius: 50%;
      opacity: 0.3;
      animation: float 15s infinite linear;
    }
    
    @keyframes float {
      0% {
        transform: translateY(100vh) translateX(0);
        opacity: 0;
      }
      10% {
        opacity: 0.3;
      }
      90% {
        opacity: 0.3;
      }
      100% {
        transform: translateY(-100vh) translateX(100px);
        opacity: 0;
      }
    }
    
    /* Glass morphism effect for panels */
    .glass-panel {
      background: rgba(30, 41, 59, 0.3);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border-color);
      border-radius: 12px;
    }
    
    /* Modern card effect */
    .card {
      background: rgba(30, 41, 59, 0.5);
      border-radius: 12px;
      box-shadow: var(--shadow-lg);
      border: 1px solid var(--border-color);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-xl);
    }
    
    /* STYLE BARU: Banner Bonus Animasi */
    .bonus-banner-container {
      position: relative;
      margin-bottom: 25px;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: var(--shadow-lg);
      border: 1px solid rgba(245, 158, 11, 0.3);
      background: rgba(15, 23, 42, 0.8);
      backdrop-filter: blur(10px);
      height: 70px;
    }
    
    .bonus-banner {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      background: var(--orange-gradient);
      overflow: hidden;
      border-radius: 12px;
    }
    
    .bonus-banner-content {
      display: flex;
      align-items: center;
      white-space: nowrap;
      animation: marquee 25s linear infinite;
      padding-left: 100%;
    }
    
    .bonus-multiple {
      display: inline-block;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      padding: 6px 12px;
      margin: 0 15px;
      font-weight: 800;
      font-size: 12px;
      color: white;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .bonus-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      margin: 0 15px;
      font-size: 16px;
      color: white;
    }
    
    .bonus-text {
      display: inline-block;
      font-weight: 800;
      font-size: 14px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
    }
    
    .bonus-divider {
      display: inline-block;
      margin: 0 15px;
      font-size: 20px;
      color: rgba(255, 255, 255, 0.7);
      font-weight: 300;
    }
    
    @keyframes marquee {
      0% {
        transform: translateX(0);
      }
      100% {
        transform: translateX(-100%);
      }
    }
    
    /* HILANGKAN: bonus-date-indicator di banner bonus */
    .bonus-date-indicator {
      display: none !important; /* DIUBAH: Sembunyikan tanggal di banner bonus */
    }
    
    /* STYLE BARU: Header Bonus dengan tanggal sejajar */
    .bonus-header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }
    
    .today-date-section {
      flex: 1;
      min-width: 250px;
    }
    
    .bonus-title-section {
      display: flex;
      align-items: center;
      gap: 15px;
      justify-content: flex-end;
      flex: 1;
      min-width: 250px;
    }
    
    .today-date {
      font-size: 16px;
      font-weight: 800;
      color: var(--light-color);
      padding: 8px 0;
      display: flex;
      align-items: center;
      font-family: 'Noto Serif JP', serif;
      letter-spacing: 0.5px;
    }
    
    .today-date i {
      margin-right: 10px;
      color: var(--gold-accent);
      font-size: 18px;
    }
    
    .today-date span {
      background: var(--gradient-accent);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-weight: 900;
    }
    
    .bonus-title-section h3 {
      margin-top: 0;
      margin-bottom: 0;
      font-size: 16px;
    }
    
    .bonus-count {
      background: var(--orange-gradient);
      color: white;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 900;
      box-shadow: var(--shadow-md);
      display: flex;
      align-items: center;
      gap: 6px;
      min-width: 100px;
      justify-content: center;
    }
    
    .bonus-count i {
      font-size: 14px;
    }
    
    /* Style untuk tampilan bonus ganda */
    .multiple-bonus .bonus-banner-content {
      animation-duration: 35s;
    }
  </style>
</head>
<body>
  <!-- Floating particles background -->
  <div class="particles" id="particles"></div>
  
  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loading-overlay">
    <div class="loading-spinner"></div>
    <div>Loading data from Google Sheets...</div>
  </div>

  <!-- Bagian Utama -->
  <div class="main-content">
    <!-- Panel Kiri - Daftar Judul -->
    <div class="left-panel glass-panel">
      <div class="left-panel-header">Ôº¨Ôº©Ôº≥Ôº¥ Ôº™ÔºµÔº§ÔºµÔº¨</div>
      <div class="left-search-container">
        <span class="search-icon">üîé</span>
        <input type="text" class="left-search-input" id="left-search-input" placeholder="Cari judul...">
      </div>
      <div id="title-list"></div>
    </div>
    
    <!-- Panel Tengah - Tabel -->
    <div class="center-panel">
      <!-- Container untuk header bonus dan tanggal -->
      <div class="bonus-header-container">
        <!-- Bagian tanggal hari ini -->
        <div class="today-date-section">
          <div class="today-date" id="today-date">
            <i class="fas fa-calendar-day"></i>
            <span id="date-text">Kamis, 11 Desember 2025</span>
          </div>
        </div>
        
        <!-- Bagian judul bonus dan counter -->
        <div class="bonus-title-section">
          <h3>Bonus Hari Ini</h3>
          <div class="bonus-count" id="bonus-count">
            <i class="fas fa-gift"></i>
            <span id="bonus-count-text">0 Bonus</span>
          </div>
        </div>
      </div>
      
      <!-- Banner bonus animasi -->
      <div class="bonus-banner-container" id="bonus-banner-container">
        <!-- DIUBAH: bonus-date-indicator dihilangkan dari banner -->
        <div class="bonus-date-indicator" id="bonus-date-indicator"></div>
        <div class="bonus-banner" id="bonus-banner">
          <div class="bonus-banner-content" id="bonus-banner-content">
            <!-- Konten bonus akan diisi oleh JavaScript -->
          </div>
        </div>
      </div>
      
      <!-- Initially show empty state -->
      <div class="empty-state" id="empty-state">
        <i class="fas fa-file-alt"></i>
        <p>Pilih judul dari list sebelah kiri untuk melihat detail memo</p>
      </div>
      
      <!-- Tables (hidden by default) -->
      <div id="tables-container" style="display: none;">
        <!-- Tabel Judul -->
        <h3>Title</h3>
        <table class="info-table card" id="title-table">
          <thead>
            <tr>
              <th>Judul</th>
              <th width="120px">Aksi</th>
            </tr>
          </thead>
          <tbody id="title-table-body"></tbody>
        </table>
        
        <!-- Tabel Isi -->
        <h3 style="margin-top: 30px;">Description</h3>
        <table class="info-table card" id="content-table">
          <thead>
            <tr>
              <th>Isi</th>
              <th width="120px">Aksi</th>
            </tr>
          </thead>
          <tbody id="content-table-body"></tbody>
        </table>
      </div>
    </div>

    <!-- Enhanced Sidebar Kanan -->
    <div class="sidebar glass-panel">
      <div class="sidebar-header">
        <i class="fas fa-clipboard-list"></i>
        Ôº¨Ôº©Ôº≥Ôº¥ Ôº≠Ôº•Ôº≠ÔºØ
      </div>
      
      <!-- Section 1: Memo Utama -->
      <div class="sidebar-section">
        <div class="sidebar-section-header">
          <i class="fas fa-sticky-note"></i>
          MEMO UTAMA
        </div>
        <div class="sidebar-item active" data-sheet="MEMO PEMBAGIAN BONUS">MEMO PEMBAGIAN BONUS</div>
        <div class="sidebar-item" data-sheet="MEMO INFORMASI BANK">MEMO INFORMASI BANK</div>
        <div class="sidebar-item" data-sheet="MEMO KENDALA PERMAINAN">MEMO KENDALA PERMAINAN</div>
        <div class="sidebar-item" data-sheet="MEMO KENDALA SISTEM">MEMO KENDALA SISTEM</div>
      </div>
      
      <!-- Section 2: Report Kendala Situs -->
      <div class="sidebar-section">
        <div class="sidebar-section-header">
          <i class="fas fa-globe"></i>
          REPORT KENDALA SITUS
        </div>
        <div class="sidebar-item" data-sheet="REPORT KENDALA ALL SITUS">REPORT KENDALA ALL SITUS</div>
      </div>
      
      <!-- Section 3: Report LineTogel -->
      <div class="sidebar-section">
        <div class="sidebar-section-header">
          <i class="fas fa-laptop-code"></i>
          REPORT LINETOGEL
        </div>
        <div class="sidebar-item" data-sheet="REPORT KENDALA LINETOGEL">REPORT KENDALA LINETOGEL</div>
      </div>
    </div>
  </div>
  
  <!-- Alert -->
  <div class="alert" id="alert">
    <i class="material-icons">check_circle</i>
    <span id="alert-message">„ÉÜ„Ç≠„Çπ„Éà„Åå„Ç≥„Éî„Éº„Åï„Çå„Åæ„Åó„Åü!</span>
  </div>
  
  <script>
    // Create floating particles
    function createParticles() {
      const particlesContainer = document.getElementById('particles');
      const particleCount = 40;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        
        // Random position
        particle.style.left = `${Math.random() * 100}%`;
        
        // Random size
        const size = Math.random() * 2 + 1;
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        
        // Random opacity
        particle.style.opacity = Math.random() * 0.4 + 0.1;
        
        // Random animation duration
        const duration = Math.random() * 20 + 10;
        particle.style.animationDuration = `${duration}s`;
        
        // Random animation delay
        particle.style.animationDelay = `${Math.random() * 5}s`;
        
        // Random color
        const colors = ['#6366f1', '#8b5cf6', '#06b6d4', '#10b981', '#f59e0b'];
        const randomColor = colors[Math.floor(Math.random() * colors.length)];
        particle.style.background = randomColor;
        
        particlesContainer.appendChild(particle);
      }
    }
    
    // Fungsi untuk menentukan bonus berdasarkan hari dan tanggal
    function getTodaysBonuses() {
      const today = new Date();
      const day = today.getDate();
      const dayOfWeek = today.getDay(); // 0 = Minggu, 1 = Senin, ...
      const month = today.getMonth() + 1; // 0 = Januari, jadi +1
      const year = today.getFullYear();
      
      const bonuses = [];
      
      // Bonus berdasarkan tanggal (1, 11, 21 setiap bulan)
      const bonusDates = [1, 11, 21];
      if (bonusDates.includes(day)) {
        bonuses.push({
          text: "PEMBAGIAN EXTRA BONUS TURNOVER SLOT",
          icon: "fas fa-coins",
          type: "extra"
        });
      }
      
      // Bonus berdasarkan hari dalam seminggu
      switch(dayOfWeek) {
        case 1: // Senin
          bonuses.push({
            text: "Pembagian BONUS CASHBACK KEKALAHAN UP TO 5% LIVEGAMES",
            icon: "fas fa-gamepad",
            type: "cashback"
          });
          bonuses.push({
            text: "BONUS CASHBACK KEKALAHAN LIVE CASINO PRAGMATIC PLAY 5%",
            icon: "fas fa-dice",
            type: "cashback"
          });
          bonuses.push({
            text: "BONUS CASHBACK KEKALAHAN ARCADE 5%",
            icon: "fas fa-arcade",
            type: "cashback"
          });
          break;
          
        case 2: // Selasa
          bonuses.push({
            text: "Pembagian BONUS CASHBACK KEKALAHAN 5% SLOT GAMES",
            icon: "fas fa-slots",
            type: "cashback"
          });
          bonuses.push({
            text: "BONUS CASHBACK KEKALAHAN 5% E-LOTTERY",
            icon: "fas fa-ticket-alt",
            type: "cashback"
          });
          break;
          
        case 4: // Kamis
          bonuses.push({
            text: "Pembagian BONUS ROLLINGAN",
            icon: "fas fa-chart-line",
            type: "rolling"
          });
          break;
      }
      
      return {
        date: today,
        dayOfWeek: dayOfWeek,
        day: day,
        month: month,
        year: year,
        bonuses: bonuses
      };
    }
    
    // Fungsi untuk menampilkan tanggal hari ini
    function displayTodayDate(bonusInfo) {
      const dateTextElement = document.getElementById('date-text');
      
      // Format tanggal untuk ditampilkan
      const daysOfWeek = ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"];
      const months = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
      
      const dayName = daysOfWeek[bonusInfo.dayOfWeek];
      const monthName = months[bonusInfo.month - 1];
      const formattedDate = `${dayName}, ${bonusInfo.day} ${monthName} ${bonusInfo.year}`;
      
      // Tampilkan tanggal
      dateTextElement.textContent = formattedDate;
    }
    
    // Fungsi untuk menampilkan bonus dalam banner animasi
    function displayBonusBanner(bonusInfo) {
      const bannerContent = document.getElementById('bonus-banner-content');
      // DIUBAH: Hapus referensi ke dateIndicator karena tidak diperlukan lagi
      const bonusCountText = document.getElementById('bonus-count-text');
      const bannerContainer = document.getElementById('bonus-banner-container');
      
      // Update jumlah bonus
      bonusCountText.textContent = `${bonusInfo.bonuses.length} Bonus`;
      
      // Bersihkan konten banner sebelumnya
      bannerContent.innerHTML = '';
      
      // Jika tidak ada bonus hari ini
      if (bonusInfo.bonuses.length === 0) {
        bannerContent.innerHTML = `
          <div class="bonus-icon"><i class="fas fa-calendar-day"></i></div>
          <div class="bonus-text">Tidak ada pembagian bonus hari ini</div>
        `;
        bannerContainer.classList.remove('multiple-bonus');
        return;
      }
      
      // Jika ada lebih dari 1 bonus, tambahkan class khusus
      if (bonusInfo.bonuses.length > 1) {
        bannerContainer.classList.add('multiple-bonus');
      } else {
        bannerContainer.classList.remove('multiple-bonus');
      }
      
      // Tambahkan elemen untuk setiap bonus
      bonusInfo.bonuses.forEach((bonus, index) => {
        // Tambahkan indikator bonus ganda jika ada lebih dari 1
        if (bonusInfo.bonuses.length > 1) {
          const multipleIndicator = document.createElement('div');
          multipleIndicator.className = 'bonus-multiple';
          multipleIndicator.innerHTML = `<i class="fas fa-star"></i> Bonus ${index + 1}`;
          bannerContent.appendChild(multipleIndicator);
        }
        
        // Tambahkan ikon bonus
        const iconDiv = document.createElement('div');
        iconDiv.className = 'bonus-icon';
        iconDiv.innerHTML = `<i class="${bonus.icon}"></i>`;
        bannerContent.appendChild(iconDiv);
        
        // Tambahkan teks bonus
        const textDiv = document.createElement('div');
        textDiv.className = 'bonus-text';
        textDiv.textContent = bonus.text;
        bannerContent.appendChild(textDiv);
        
        // Tambahkan pembatas antara bonus (kecuali untuk bonus terakhir)
        if (index < bonusInfo.bonuses.length - 1) {
          const divider = document.createElement('div');
          divider.className = 'bonus-divider';
          divider.innerHTML = '‚ú¶';
          bannerContent.appendChild(divider);
        }
      });
      
      // Duplikasi konten untuk animasi mulus
      const cloneContent = bannerContent.cloneNode(true);
      bannerContent.appendChild(cloneContent);
    }
    
    // Initialize particles and bonus banner on page load
    document.addEventListener('DOMContentLoaded', function() {
      createParticles();
      
      // Tampilkan bonus berdasarkan hari dan tanggal
      const bonusInfo = getTodaysBonuses();
      
      // Tampilkan tanggal hari ini
      displayTodayDate(bonusInfo);
      
      // Tampilkan banner bonus
      displayBonusBanner(bonusInfo);
      
      const sidebarItems = document.querySelectorAll('.sidebar-item');
      const leftSearchInput = document.getElementById('left-search-input');
      const titleList = document.getElementById('title-list');
      const titleTableBody = document.getElementById('title-table-body');
      const contentTableBody = document.getElementById('content-table-body');
      const alertBox = document.getElementById('alert');
      const alertMessage = document.getElementById('alert-message');
      const emptyState = document.getElementById('empty-state');
      const tablesContainer = document.getElementById('tables-container');
      const loadingOverlay = document.getElementById('loading-overlay');
      
      let allData = {};
      let currentSheet = 'MEMO PEMBAGIAN BONUS';
      let currentData = [];
      
      // Show loading overlay
      loadingOverlay.classList.remove('hidden');
      
      // Load data from Google Sheets
      loadAllSheetData();
      
      // Handle klik sidebar
      sidebarItems.forEach(item => {
        item.addEventListener('click', function() {
          sidebarItems.forEach(i => i.classList.remove('active'));
          this.classList.add('active');
          currentSheet = this.getAttribute('data-sheet');
          loadSheetData(currentSheet);

          // Sembunyikan tabel dan tampilkan empty state saat memilih kategori baru
          tablesContainer.style.display = 'none';
          emptyState.style.display = 'flex';
        });
      });

      // Function to load all sheet data
      async function loadAllSheetData() {
        try {
          const promises = Object.keys(SHEETS).map(sheetName => 
            loadSheetFromGoogleSheets(sheetName)
          );
          
          const results = await Promise.all(promises);
          
          // Combine all results into allData object
          Object.keys(SHEETS).forEach((sheetName, index) => {
            allData[sheetName] = results[index];
          });
          
          // Hide loading overlay
          loadingOverlay.classList.add('hidden');
          
          // Load initial sheet data
          loadSheetData(currentSheet);
          
        } catch (error) {
          console.error('Error loading data:', error);
          showAlert('Gagal memuat data dari Google Sheets', 'error');
          loadingOverlay.classList.add('hidden');
        }
      }
      
      // Function to load data from Google Sheets for a specific sheet
      async function loadSheetFromGoogleSheets(sheetName) {
        const gid = SHEETS[sheetName];
        let url = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json`;
        
        // PENAMBAHAN: Logika khusus untuk MEMO INFORMASI BANK
        if (sheetName === "MEMO INFORMASI BANK") {
          console.log(`Mencoba memuat data untuk: ${sheetName}`);
          
          // Coba metode alternatif terlebih dahulu untuk MEMO INFORMASI BANK
          try {
            const alternativeData = await tryAlternativeMethodForBankInfo();
            if (alternativeData && alternativeData.length > 0) {
              console.log(`Berhasil memuat data ${sheetName} dengan metode alternatif: ${alternativeData.length} item`);
              return alternativeData;
            }
          } catch (altError) {
            console.warn(`Metode alternatif gagal untuk ${sheetName}:`, altError);
          }
          
          // Jika metode alternatif gagal, coba metode standar
          url += `&sheet=${encodeURIComponent(sheetName)}`;
          console.log(`Menggunakan URL standar untuk ${sheetName}`);
        } else {
          // Untuk sheet lain, gunakan logika asli
          if (gid !== 0) {
            url += `&gid=${gid}`;
          } else {
            url += `&sheet=${encodeURIComponent(sheetName)}`;
          }
        }
        
        try {
          const response = await fetch(url);
          
          // Periksa apakah response valid
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          
          const text = await response.text();
          
          // Periksa apakah response kosong
          if (!text || text.trim().length === 0) {
            console.warn(`Response kosong untuk sheet: ${sheetName}`);
            return [];
          }
          
          // Parse the JSONP response
          const jsonText = text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1);
          const json = JSON.parse(jsonText);
          
          // Extract data from the response
          const sheetData = [];
          if (json.table && json.table.rows) {
            json.table.rows.forEach((row, index) => {
              // Skip header row (index 0) dan cek apakah row memiliki data
              if (index > 0 && row.c && row.c.length > 0) {
                // Ambil data kolom 1 sebagai judul
                const title = row.c[0] ? (row.c[0].v || '') : '';
                // Ambil data kolom 2 sebagai konten (jika ada)
                const content = row.c[1] ? (row.c[1].v || '') : '';
                
                if (title && title.toString().trim() !== '') {
                  sheetData.push({
                    title: title.toString(),
                    content: content.toString()
                  });
                }
              }
            });
          }
          
          console.log(`Data loaded for ${sheetName}:`, sheetData.length, "items");
          return sheetData;
        } catch (error) {
          console.error(`Error loading sheet ${sheetName}:`, error);
          
          // PENAMBAHAN: Untuk MEMO INFORMASI BANK, coba metode cadangan lain
          if (sheetName === "MEMO INFORMASI BANK") {
            console.log("Mencoba metode cadangan untuk MEMO INFORMASI BANK...");
            return tryAlternativeMethodForBankInfo();
          }
          
          return [];
        }
      }

      // PENAMBAHAN: Fungsi khusus untuk MEMO INFORMASI BANK
      async function tryAlternativeMethodForBankInfo() {
        try {
          console.log("Mencoba metode alternatif khusus untuk MEMO INFORMASI BANK");
          
          // Coba beberapa kemungkinan struktur URL
          const urlVariations = [
            // Coba dengan nama sheet yang berbeda (mungkin ada spasi atau format berbeda)
            `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&sheet=MEMO%20INFORMASI%20BANK`,
            `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&sheet=Memo%20Informasi%20Bank`,
            `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&sheet=Memo%20Informasi%20bank`,
            // Coba tanpa parameter sheet (mungkin sheet pertama atau default)
            `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json`
          ];
          
          for (let i = 0; i < urlVariations.length; i++) {
            try {
              const url = urlVariations[i];
              console.log(`Mencoba URL: ${url}`);
              
              const response = await fetch(url);
              if (!response.ok) continue;
              
              const text = await response.text();
              if (!text || text.trim().length === 0) continue;
              
              const jsonText = text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1);
              const json = JSON.parse(jsonText);
              
              // Cek apakah ini sheet yang kita cari
              if (json.table && json.table.rows && json.table.rows.length > 1) {
                // Cek baris pertama untuk konfirmasi apakah ini MEMO INFORMASI BANK
                const firstRow = json.table.rows[0];
                if (firstRow.c && firstRow.c[0] && firstRow.c[0].v) {
                  const firstCell = firstRow.c[0].v.toString().toUpperCase();
                  if (firstCell.includes("BANK") || firstCell.includes("INFORMASI")) {
                    console.log(`Found potential MEMO INFORMASI BANK data at variation ${i}`);
                  }
                }
                
                const sheetData = [];
                json.table.rows.forEach((row, index) => {
                  if (index > 0 && row.c && row.c[0] && row.c[0].v) {
                    const title = row.c[0].v;
                    const content = row.c[1] ? row.c[1].v : '';
                    
                    if (title.toString().trim() !== '') {
                      sheetData.push({
                        title: title.toString(),
                        content: content.toString()
                      });
                    }
                  }
                });
                
                if (sheetData.length > 0) {
                  console.log(`Berhasil memuat data dengan metode alternatif: ${sheetData.length} item`);
                  return sheetData;
                }
              }
            } catch (variationError) {
              console.log(`Variation ${i} gagal:`, variationError);
              continue;
            }
          }
          
          console.warn("Semua metode alternatif gagal untuk MEMO INFORMASI BANK");
          return [];
        } catch (altError) {
          console.error("Metode alternatif khusus gagal:", altError);
          return [];
        }
      }
      
      // Fungsi untuk memuat data sheet
      function loadSheetData(sheetName) {
        if (allData[sheetName]) {
          currentData = allData[sheetName];
          renderTitleList();
          // Clear tables when loading new sheet
          titleTableBody.innerHTML = '';
          contentTableBody.innerHTML = '';
          
          // PENAMBAHAN: Log untuk debugging
          console.log(`${sheetName} data loaded:`, currentData.length, "items");
        } else {
          currentData = [];
          renderTitleList();
          showAlert(`Data untuk ${sheetName} tidak ditemukan`, 'error');
          console.error(`Data ${sheetName} tidak ada di allData`);
        }
      }
      
      // Render daftar judul di panel kiri
      function renderTitleList() {
        titleList.innerHTML = '';
        
        if (currentData.length === 0) {
          const emptyDiv = document.createElement('div');
          emptyDiv.className = 'title-item';
          emptyDiv.textContent = 'Tidak ada data';
          emptyDiv.style.color = 'var(--text-secondary)';
          emptyDiv.style.fontStyle = 'italic';
          emptyDiv.style.cursor = 'default';
          titleList.appendChild(emptyDiv);
          return;
        }
        
        currentData.forEach((item, index) => {
          const div = document.createElement('div');
          div.className = 'title-item';
          div.textContent = item.title;
          div.addEventListener('click', () => {
            showItemDetails(index);
          });
          titleList.appendChild(div);
        });
      }
      
      // Tampilkan detail item di tabel
      function showItemDetails(index) {
        // Show tables and hide empty state
        tablesContainer.style.display = 'block';
        emptyState.style.display = 'none';
        
        titleTableBody.innerHTML = '';
        contentTableBody.innerHTML = '';
        
        const item = currentData[index];
        
        // Tabel Judul (hanya menampilkan 1 item yang dipilih)
        const titleRow = document.createElement('tr');
        titleRow.innerHTML = `
          <td class="table-content">${escapeHtml(item.title)}</td>
          <td>
            <button class="copy-btn" data-text="${cleanTextForCopy(item.title)}" data-type="Judul ">
              <i class="material-icons">content_copy</i> Copy
            </button>
          </td>
        `;
        titleTableBody.appendChild(titleRow);
        
        // Tabel Isi (hanya menampilkan 1 item yang dipilih)
        const contentRow = document.createElement('tr');
        contentRow.innerHTML = `
          <td class="table-content">${escapeHtml(item.content)}</td>
          <td>
            <button class="copy-btn" data-text="${cleanTextForCopy(item.content)}" data-type="Isi ">
              <i class="material-icons">content_copy</i> Copy
            </button>
          </td>
        `;
        contentTableBody.appendChild(contentRow);
        
        attachCopyListeners();
      }
      
      // Fungsi untuk membersihkan teks untuk disalin (tanpa <br>)
      function cleanTextForCopy(text) {
        if (!text) return '';
        // Hapus tag <br> dan ganti dengan newline
        return text.toString()
          .replace(/<br\s*\/?>/gi, '\n')
          .replace(/&nbsp;/g, ' ')
          .replace(/&amp;/g, "&")
          .replace(/&lt;/g, "<")
          .replace(/&gt;/g, ">")
          .replace(/&quot;/g, '"')
          .replace(/&#039;/g, "'");
      }
      
      // Fungsi untuk escape HTML (untuk tampilan)
      function escapeHtml(unsafe) {
        if (!unsafe) return '';
        return unsafe.toString()
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;")
          .replace(/\n/g, "<br>");
      }
      
      // Fungsi pencarian di panel kiri (untuk judul saja)
      leftSearchInput.addEventListener('input', function() {
        const query = this.value.toLowerCase();
        const titleItems = document.querySelectorAll('.title-item');
        
        titleItems.forEach(item => {
          const title = item.textContent.toLowerCase();
          if (title.includes(query)) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
      });
      
      // Attach event listeners to copy buttons
      function attachCopyListeners() {
        document.querySelectorAll('.copy-btn').forEach(btn => {
          // Remove any existing click handlers to prevent duplicates
          btn.replaceWith(btn.cloneNode(true));
        });
        
        document.querySelectorAll('.copy-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const text = this.getAttribute('data-text');
            const type = this.getAttribute('data-type');
            copyToClipboard(text, type);
          });
        });
      }
      
      // Global function to copy text
      window.copyToClipboard = function(text, type) {
        // Teks sudah dibersihkan dari tag <br> di fungsi cleanTextForCopy
        const cleanedText = text;
        
        navigator.clipboard.writeText(cleanedText).then(() => {
          showAlert(`${type}berhasil di Copy!`, 'success');
        }).catch(err => {
          console.error('Gagal menyalin teks: ', err);
          showAlert('Gagal menyalin teks!', 'error');
          
          // Fallback for browsers that don't support navigator.clipboard
          const textarea = document.createElement('textarea');
          textarea.value = cleanedText;
          document.body.appendChild(textarea);
          textarea.select();
          try {
            document.execCommand('copy');
            showAlert(`${type}berhasil di Copy!`, 'success');
          } catch (err) {
            console.error('Metode salin alternatif gagal: ', err);
            showAlert('Gagal menyalin teks!', 'error');
          }
          document.body.removeChild(textarea);
        });
      };
      
      // Function to show alert
      function showAlert(message, type = 'success') {
        alertMessage.textContent = message;
        alertBox.className = 'alert';
        alertBox.classList.add('show');
        if (type === 'error') {
          alertBox.classList.add('error');
        }
        
        setTimeout(() => {
          alertBox.classList.remove('show');
        }, 3000);
      }
    });
    
    // Google Sheets API configuration
    const SPREADSHEET_ID = '1V9rNIOgLHxY73Ud1WBHhZCBZqXqTR9ZTLiedwvL5FJ4';
    const API_KEY = '';
    const SHEETS = {
      'MEMO PEMBAGIAN BONUS': 0,
      'MEMO INFORMASI BANK': 0,
      'MEMO KENDALA PERMAINAN': 0,
      'MEMO KENDALA SISTEM': 0,
      'REPORT KENDALA ALL SITUS': 0,
      'REPORT KENDALA LINETOGEL': 0
    };
  </script>
</body>
</html>
